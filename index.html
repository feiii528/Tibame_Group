<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë≤°ÂãôÂÅ•Â∫∑Â∫¶Ë©ï‰º∞</title>
    <!-- ‰ΩøÁî®ÊúÄÊñ∞ÁâàÊú¨ÁöÑ Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- ÊàñËÄÖÊñπÊ°à 2Ôºö‰ΩøÁî® emoji ‰ΩúÁÇ∫ faviconÔºàÊé®Ëñ¶ÔºåÊØîËºÉÁ∞°ÂñÆÔºâ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí∞</text></svg>">
    
    <style>
        body {
            font-family: "Times New Roman", Times, serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
            padding-top: 100px; /* È†êÁïôÁ©∫ÈñìÔºåÈÅøÂÖçÂÖßÂÆπË¢´Êìã‰Ωè */
        }

        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, #6a89cc, #4a69bd);
            color: white;
            padding: 60px; 
            text-align: center;
            font-size: 42px;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            height: 50px;  /* Ê∏õÂ∞ëÈ´òÂ∫¶ */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .navbar {
            position: fixed;
            top: 40px; /* Âõ∫ÂÆöÂú®Ê®ôÈ°åÊ¨Ñ‰∏ãÊñπ */
            width: 100%;
            z-index: 1000;
            background-color: #4a6eb1;
            padding: 10px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 0 auto;
            padding: 0 20px;
            max-width: 1400px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
            margin-top: 90px;  /* Ë™øÊï¥È†ÇÈÉ®ÈÇäË∑ù */
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 4fr 1fr;
            gap: 20px;
        }

        .content-area {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .form-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .form-item {
            margin-bottom: 20px;
        }

        .form-item select,
        .form-item input[type="number"],
        .form-item input[type="file"] {
            border: none;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            width: 100%;
        }

        .default-field {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .default-field-label {
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
        }

        .add-field-btn {
            background: #4a69bd;
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }

        .add-field-btn:hover {
            background: #3c5aa9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(74, 105, 189, 0.3);
        }

        .add-field-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .preset-label {
            flex: 1;
            background: #4CAF50;
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            min-width: 80px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .preset-label:hover {
            background: #dc3545;
            transform: translateY(-2px);
        }

        .submit-button {
            background: #28a745;
            color: white;
            padding: 12px 24px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            width: 100%;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .submit-button:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .submit-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .sidebar-right {
            position: sticky;
            top: 60px;
            height: fit-content;
        }

        .knowledge-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .knowledge-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        .knowledge-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .knowledge-card h3 {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .knowledge-card p {
            color: #666;
            line-height: 1.6;
        }

        .features-container {
            margin-top: 30px;
        }

        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .threshold-container {
            position: relative;
            margin: 20px 0;
        }

        .threshold-markers {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            height: 20px;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
        }

        .threshold-marker {
            font-size: 20px;
            color: #4a69bd;
        }

        #threshold {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(to right, #4CAF50 50%, #ddd 50%);
            outline: none;
            margin: 20px 0;
        }

        #threshold::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #4a69bd;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        #threshold-value {
            font-size: 20px;
            color: #2d3748;
            margin-top: 10px;
            text-align: center;
        }

        .welcome-section {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            max-width: 600px;
            transition: all 0.3s ease;
        }

        .welcome-section h1 {
            font-size: 2em;
            color: #333;
            margin-bottom: 15px;
        }

        .welcome-section p {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        .cta-button {
            font-family: "Times New Roman", Times, serif;
            font-size: 24px;
            padding: 15px 40px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
            background: linear-gradient(135deg, #45a049, #4CAF50);
        }

        .content-wrapper {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .content-wrapper.active {
            opacity: 1;
            transform: translateY(0);
        }

        .animate-bounce {
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-20px);
            }
            60% {
                transform: translateY(-10px);
            }
        }

        /* Â∞éËà™Ê¨ÑÊ®£Âºè */
        .navbar {
            position: fixed;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 1400px;
            background: linear-gradient(135deg, #4a69bd, #6a89cc);
            padding: 15px 0;
            z-index: 9;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 15px;
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            font-size: 20px;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        /* È†êË®≠ÊåâÈàïÊ®£Âºè */
        .preset-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #10B981;
            color: #10B981;
            background: white;
            border-radius: 0.5rem;
            min-width: 80px;
            text-align: center;
            transition: all 0.3s;
        }

        .preset-btn:hover {
            background: #10B981;
            color: white;
        }

        /* Âà™Èô§ÊåâÈàïÊ®£Âºè */
        .delete-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #10B981;
            color: #10B981;
            background: white;
            border-radius: 0.5rem;
            min-width: 80px;
            text-align: center;
            transition: all 0.3s;
        }

        .delete-btn:hover {
            border-color: #EF4444;
            color: white;
            background: #EF4444;
        }

        /* ÁµêÊûúÈ°ØÁ§∫Ê®£Âºè */
        .result-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .result-section:hover {
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            transform: translateY(-2px);
        }

        .result-content {
            color: #2d3748;
            line-height: 1.8;
            margin-top: 10px;
            font-size: 16px;
        }
        
        /* Êñ∞Â¢ûÊ®£ÂºèÔºåÁî®ÊñºË≤°ÂãôÂàÜÊûêÁµêÊûúÂçÄÂ°ä */
        #analysis-results {
            margin-top: 20px;
            margin-bottom: 20px;
            border-top: 1px solid #e2e8f0;
            padding-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        #analysis-results .result-section {
            background: #ffffff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-left: none;
            position: relative;
        }
        
        #analysis-results .result-section::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(to right, transparent, #e2e8f0, transparent);
        }
        
        #analysis-results .analysis-title {
            color: #4a69bd;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            display: block;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        /* ËôïÁêÜÊ®°ÂûãË≥áË®äÁâπÊÆäÊ®£Âºè */
        #section0 {
            background: #f8fafc;
        }
        
        #section0 .analysis-title {
            font-size: 20px;
        }
        
        /* ÁÇ∫ÊâÄÊúâÂÖßÂÆπ‰∏≠ÁöÑÊ®ôÈ°åÊ∑ªÂä†ËóçËâ≤Á≤óÈ´îÊ®£Âºè */
        #analysis-results .result-content strong,
        #analysis-results .result-content b,
        #analysis-results .result-content h1,
        #analysis-results .result-content h2,
        #analysis-results .result-content h3,
        #analysis-results .result-content h4,
        #analysis-results .result-content h5,
        #analysis-results .result-content h6 {
            color: #4a69bd;
            font-weight: bold;
        }
        
        /* ‰∏ãËºâÊåâÈàïÊ®£ÂºèÂÑ™Âåñ */
        .download-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            display: inline-block;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #45a049, #4CAF50);
        }
        
        /* ÁµêÊûúÂúñÁâáÈ°ØÁ§∫Ê®£Âºè */
        .result-image {
            max-width: 100%;
            border-radius: 8px;
            margin: 15px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Ê∑ªÂä†ÂàÜÈöîÁ∑öÊ®£Âºè */
        .section-divider {
            height: 1px;
            background: #e2e8f0;
            margin: 10px 0 20px 0;
            opacity: 0.3;
            width: 100%;
        }

        /* ‰øÆÊîπÊ®ôÈ°åÊ®£Âºè */
        .analysis-title {
            color: #4a69bd;
            font-weight: bold;
            display: inline;
            font-size: 16px;
        }

        /* ‰øÆÊîπË°®ÂñÆÊ®ôÁ±§Â≠óÈ´îÂ§ßÂ∞è */
        .form-item label {
            font-size: 16px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 10px;
            display: block;
        }

        /* ÂúñË°®ÂÆπÂô®Ê®£Âºè */
        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        /* ÂàÜÈ†ÅÂºè UI Ê®£Âºè */
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .tab {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #f3f4f6;
        }

        .tab.active {
            background-color: #2563eb;
            color: white;
        }

        /* Êñ∞Â¢ûÈáëËâ≤ÂíåÁ∂†Ëâ≤‰∏ªÈ°å */
        .theme-gold {
            color: #d4af37;
        }

        .theme-green {
            color: #10b981;
        }

        /* FAQ Ê®£Âºè */
        .faq-section {
            margin-top: 2rem;
            padding: 1rem;
            background-color: #f8fafc;
            border-radius: 1rem;
        }

        .faq-item {
            margin-bottom: 1rem;
            padding: 1rem;
            background-color: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .faq-item:hover {
            transform: translateX(10px);
        }

        /* ÂäüËÉΩÂç°ÁâáÂÆπÂô® */
        .features-container {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
            padding-top: 40px;
        }

        .features-container.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* ÂàÜÊûêÂçÄÂ°äÊ®£Âºè */
        #analysis-section {
            display: none;
            padding-top: 40px;
            font-family: "Times New Roman", Times, serif;
        }

        #analysis-section.active {
            display: block;
        }

        /* Ë≤°ÂãôÁü•Ë≠òÂ∞èÊïôÂÆ§Ê®£Âºè */
        .knowledge-section {
            position: sticky;
            top: 200px;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid #e2e8f0;
            display: none;
        }

        .knowledge-section.visible {
            display: block;
        }

        .knowledge-title {
            font-size: 22px;
            color: #4a69bd;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .knowledge-card {
            background: #f8faff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .knowledge-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 105, 189, 0.1);
        }

        .knowledge-card h3 {
            color: #4a69bd;
            font-size: 18px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .knowledge-card p {
            color: #4a5568;
            line-height: 1.6;
            font-size: 16px;
        }

        /* ‰∏ªË¶ÅÂÆπÂô®Ê®£Âºè */
        .main-container {
            display: grid;
            grid-template-columns: 1fr 3fr 1fr;
            gap: 20px;
            width: 100%;
            max-width: 2000px;
            margin: 0 auto;
            padding: 20px;
        }

        .content-area {
            grid-column: 2;
        }

        .sidebar-right {
            grid-column: 3;
            margin-top: 40px;
        }

        /* Áü•Ë≠òÂ∞èÊïôÂÆ§Á∂≤Ê†ºÂ∏ÉÂ±Ä */
        .knowledge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            margin-top: 40px;  /* Â¢ûÂä†È†ÇÈÉ®ÈÇäË∑ù */
        }

        .knowledge-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .knowledge-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .knowledge-card h3 {
            font-size: 1.25rem;
            color: #4a69bd;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .knowledge-card p {
            color: #4a5568;
            line-height: 1.8;
            font-size: 1rem;
        }

        /* Ê≠∑Âè≤Êï∏ÊìöÂçÄÂ°äÊ®£Âºè */
        #history-content {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* ËÅØÁµ°Ë°®ÂñÆÊ®£Âºè */
        .contact-form {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* ÂÖßÂÆπÂåÖË£ùÂô®ÈÅéÊ∏°ÊïàÊûú */
        .content-wrapper {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .content-wrapper.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Â∞éËà™ÈèàÊé•ÊøÄÊ¥ªÁãÄÊÖã */
        .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* ‰øÆÊîπË≤°ÂãôÂàÜÊûêÂçÄÂ°äÁöÑÂ≠óÈ´îÂíåÂ§ßÂ∞è */
        #analysis-section {
            font-family: "Times New Roman", Times, serif;
        }

        #analysis-section label {
            font-size: 22px;
            font-weight: bold;
        }

        #analysis-section input,
        #analysis-section select {
            font-size: 20px;
            padding: 12px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            width: 100%;
            transition: all 0.3s ease;
        }

        #analysis-section input:focus,
        #analysis-section select:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        .default-field {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .default-field:hover {
            border-color: #4CAF50;
            transform: translateY(-2px);
        }

        .default-field-label {
            background: #4CAF50;
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 18px;
        }

        .download-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #45a049, #4CAF50);
        }

        /* ‰øÆÊîπËº∏ÂÖ•ÁµÑÊ®£Âºè */
        .input-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            background: white;
        }

        .input-group select {
            flex: 5;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
        }

        .input-group input {
            flex: 2;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            -moz-appearance: textfield;
        }

        .input-group input::-webkit-outer-spin-button,
        .input-group input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-group .preset-label {
            flex: 1;
            background: #4CAF50;
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            min-width: 80px;
            cursor: pointer;
        }

        /* ‰∏ãËºâÊåâÈàïÊ®£Âºè */
        .download-section {
            margin-top: 20px;
            text-align: center;
        }

        .download-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #45a049, #4CAF50);
        }

        /* Ê∑ªÂä†Ê®£Âºè */
        .notice-section {
            transition: all 0.3s ease;
            padding: 20px;
            margin-top: 30px;
        }
        
        .notice-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .result-section {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        .result-capture {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }
        
        .result-capture .result-content {
            font-size: 16px;
            line-height: 1.8;
            white-space: pre-wrap;
        }

        /* Êñ∞Â¢ûÊ®£Âºè */
        .numbered-title {
            color: #4a69bd;
            font-weight: bold;
            display: block;
            margin: 20px 0 10px 0;
            font-size: 20px;
        }

        .delete-all-btn {
            background-color: #f44336;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .delete-all-btn:hover {
            background-color: #d32f2f;
        }

        .button-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: flex-end;
        }

        .download-btn {
            text-decoration: none;
            display: inline-block;
        }

        .history-record {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .history-record:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .record-header {
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .record-content {
            padding: 15px 0;
        }

        .input-summary {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .input-summary h4 {
            color: #4a69bd;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .input-summary ul {
            list-style: none;
            padding: 0;
        }

        .input-summary li {
            padding: 5px 0;
            color: #4a5568;
        }

        .button-container {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 15px;
        }

        .delete-all-btn {
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .delete-all-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .download-btn, .delete-btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 100px;
        }

        .download-btn {
            background: #28a745;
            color: white;
            border: none;
        }

        .download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
        }

        .delete-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .history-btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: none;
            font-weight: bold;
            margin: 0 5px;
        }

        .history-btn.download-btn {
            background: #28a745;
            color: white;
        }

        .history-btn.download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .history-btn.delete-btn {
            background: #dc3545;
            color: white;
        }

        .history-btn.delete-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .button-container {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        /* Ê≠∑Âè≤Ë®òÈåÑÁõ∏ÈóúÊ®£Âºè */
        .history-container {
            padding: 20px;
        }

        .history-records {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .history-record {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .history-record:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .record-content {
            width: 100%;
        }

        .record-content img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .history-btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            min-width: 120px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .history-btn.download-btn {
            background: #28a745;
            color: white;
        }

        .history-btn.download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .history-btn.delete-btn {
            background: #dc3545;
            color: white;
        }

        .history-btn.delete-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .delete-all-btn {
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .delete-all-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        /* ËÅØÁµ°Ë°®ÂñÆÁõ∏ÈóúÊ®£Âºè */
        .contact-form input,
        .contact-form textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
        }

        .contact-form input:focus,
        .contact-form textarea:focus {
            border-color: #4a69bd;
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 105, 189, 0.1);
        }

        .contact-form button[type="submit"] {
            width: 100%;
            padding: 12px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .contact-form button[type="submit"]:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .contact-form button[type="submit"]:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        /* ‰øÆÊîπË≤°ÂãôÊØîÁéáÊü•Ë©¢Â∑•ÂÖ∑ÂíåË≤°ÂãôÁü•Ë≠òÂ∞èÊïôÂÆ§‰πãÈñìÁöÑÈñìË∑ù */
        .knowledge-card.mb-8 {
            margin-bottom: 80px !important;  /* Â¢ûÂä†Â∫ïÈÉ®ÈÇäË∑ù */
        }

        /* Á¢∫‰øùÊ®ôÈ°åÂú®ÊªæÂãïÊôÇÊ∂àÂ§± */
        @media screen and (max-width: 100%) {
            .fixed-header {
                position: absolute;
            }
        }

        /* Ê∑ªÂä† Threshold ÊèêÁ§∫ÊñáÂ≠óÊ†∑Âºè */
        .threshold-description {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            background-color: #f8f9fa;
        }

        .threshold-icon {
            font-size: 24px;
            font-style: normal;
            margin-right: 10px;
        }

        .threshold-text {
            font-style: normal;
            margin-bottom: 5px;
        }

        .threshold-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding: 15px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .threshold-info i {
            font-size: 24px;
        }

        .threshold-info-content {
            flex: 1;
        }

        .threshold-info-title {
            font-weight: bold;
            color: #4a69bd;
            margin-bottom: 5px;
        }

        .threshold-info-text {
            color: #666;
            font-size: 14px;
        }

        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }

        .history-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            transition: transform 0.3s ease;
        }

        .history-card:hover {
            transform: translateY(-5px);
        }

        .history-card-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4a69bd;
            margin-bottom: 15px;
        }

        .history-card-content {
            margin-bottom: 20px;
        }

        .history-card-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #4a69bd;
        }

        .history-card-actions {
            display: flex;
            gap: 10px;
        }

        .history-btn {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .history-btn.download-btn {
            background: #28a745;
            color: white;
        }

        .history-btn.delete-btn {
            background: #dc3545;
            color: white;
        }

        .welcome-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .instruction-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }
        
        .history-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.2s;
        }
        
        .history-card:hover {
            transform: translateY(-5px);
        }
        
        .history-card-header {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .history-card-header h3 {
            margin: 0;
            font-size: 1rem;
            color: #333;
        }
        
        .history-card-content {
            padding: 15px;
        }
        
        .history-info {
            margin-bottom: 15px;
        }
        
        .prediction {
            font-weight: bold;
            margin: 5px 0;
        }
        
        .prediction.healthy {
            color: #28a745;
        }
        
        .prediction.unhealthy {
            color: #dc3545;
        }
        
        .health-score {
            color: #666;
            margin: 5px 0;
        }
        
        .history-image-container {
            width: 100%;
            height: 200px;
            overflow: hidden;
            border-radius: 5px;
        }
        
        .history-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .history-card-actions {
            padding: 15px;
            border-top: 1px solid #eee;
            text-align: right;
        }
        
        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .delete-btn:hover {
            background: #c82333;
        }
        
        .welcome-message {
            text-align: center;
            padding: 40px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 20px;
        }
        
        .welcome-message h3 {
            color: #333;
            margin-bottom: 20px;
        }
        
        .welcome-message ul {
            list-style: none;
            padding: 0;
        }
        
        .welcome-message li {
            margin: 10px 0;
            color: #666;
        }
        
        .error-message {
            text-align: center;
            padding: 40px;
            background: #fff3f3;
            border-radius: 10px;
            margin: 20px;
            color: #dc3545;
        }

        .result-section {
            margin: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .result-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .section {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }

        .section h3 {
            color: #007bff;
            margin-top: 0;
            margin-bottom: 15px;
        }

        .section p {
            margin: 8px 0;
            color: #333;
            line-height: 1.5;
        }

        .delete-all-container {
            text-align: right;
            margin: 20px;
        }

        .delete-all-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 1rem;
        }

        .delete-all-btn:hover {
            background: #c82333;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .delete-btn i {
            font-size: 0.9rem;
        }

        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .history-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .history-card-header {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .analysis-date {
            margin: 0;
            color: #007bff;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .history-card-content {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .history-info {
            margin-bottom: 20px;
        }
        
        .financial-health {
            font-size: 1.2rem;
            color: #333;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .prediction {
            font-size: 1.2rem;
            margin: 10px 0;
            font-weight: 500;
        }
        
        .prediction.healthy {
            color: #28a745;
        }
        
        .prediction.unhealthy {
            color: #dc3545;
        }
        
        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
            width: 100%;
            margin-top: auto;
        }
        
        .delete-btn:hover {
            background: #c82333;
        }
        
        .welcome-message {
            text-align: center;
            padding: 40px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 800px;
        }
        
        .welcome-message h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .welcome-message ul {
            list-style: none;
            padding: 0;
        }
        
        .welcome-message li {
            margin: 15px 0;
            color: #666;
            font-size: 1.1rem;
        }
        
        @media (max-width: 768px) {
            .history-grid {
                grid-template-columns: 1fr;
            }
        }
                /* ÁèæÊúâÊ®£Âºè */
                .model-selection {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }


        .model-selection label {
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }


        .model-selection select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            color: #333;
            background-color: white;
            cursor: pointer;
            min-width: 200px;
        }


        .model-selection select:hover {
            border-color: #999;
        }


        .model-selection select:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }

    </style>
</head>
<body>
    <div class="fixed-header">
        üí∞ Ë≤°ÂãôÂÅ•Â∫∑Â∫¶ËàáÈ¢®Èö™Ë©ï‰º∞
    </div>

    <nav class="navbar">
        <div class="nav-links">
            <a href="#home" class="nav-link">È¶ñÈ†Å</a>
            <a href="#analysis" class="nav-link">Ë≤°ÂãôÂàÜÊûê</a>
            <a href="#knowledge" class="nav-link">Ë≤°ÂãôÁü•Ë≠òÂ∞èÊïôÂÆ§</a>
            <a href="#history" class="nav-link">Ê≠∑Âè≤Êï∏Êìö</a>
            <a href="#contact" class="nav-link">ËÅØÁµ°ÊàëÂÄë</a>
        </div>
    </nav>

    <div class="container">
        <div class="main-container">
            <!-- Â∑¶ÂÅ¥Á©∫ÁôΩÂçÄ -->
            <div class="sidebar-left"></div>

            <!-- ‰∏≠ÈñìÂÖßÂÆπÂçÄ -->
            <div class="content-area">
                <!-- È¶ñÈ†ÅÂÖßÂÆπ -->
                <div id="home" class="content-wrapper">
                    <div class="welcome-section">
                        <h1>üëã Ê≠°Ëøé‰ΩøÁî®Ë≤°ÂãôÂÅ•Â∫∑Â∫¶Ë©ï‰º∞Á≥ªÁµ±</h1>
                        <p>Êú¨Á≥ªÁµ±Êèê‰æõÂ∞àÊ•≠ÁöÑË≤°ÂãôÂàÜÊûêÂíåÈ¢®Èö™Ë©ï‰º∞ÊúçÂãôÔºåÂπ´Âä©ÊÇ®ÂÅöÂá∫ÊòéÊô∫ÁöÑÊ±∫Á≠ñ„ÄÇ</p>
                        <button onclick="navigateToAnalysis()" class="cta-button animate-bounce">
                            ÈñãÂßãÂàÜÊûê ‚ûú
                        </button>
                    </div>
                    
                </div>

                <!-- Ë≤°ÂãôÂàÜÊûêÂçÄÂ°ä -->
                <div id="analysis" class="content-wrapper">
                    <div class="form-container">
                        <div class="form-item">
                            <label for="inputMethod">ÈÅ∏ÊìáËº∏ÂÖ•ÊñπÂºè:</label>
                            <select id="inputMethod" onchange="toggleInputMethod()">
                                <option value="manual">ÊâãÂãïËº∏ÂÖ•</option>
                                <option value="file">‰∏äÂÇ≥Ê™îÊ°à</option>
                            </select>
                        </div>

                        <!-- ÊâãÂãïËº∏ÂÖ•ÂçÄÂüü -->
                        <div id="manual-input">
                            <div class="form-item">
                                <label>Ë≤°ÂãôÊØîÁéáËº∏ÂÖ•:</label>
                                <div id="fields-container">
                                    <div class="input-group">
                                        <select disabled>
                                            <option selected>Net Income to Total Assets</option>
                                        </select>
                                        <input type="number" placeholder="Ëº∏ÂÖ•Êï∏ÂÄº" min="0.0000" max="999.9999" step="0.0001">
                                        <span class="preset-label">È†êË®≠</span>
                                    </div>
                                    <div class="input-group">
                                        <select disabled>
                                            <option selected>Net Income to Stockholder's Equity</option>
                                        </select>
                                        <input type="number" placeholder="Ëº∏ÂÖ•Êï∏ÂÄº" min="0.0000" max="999.9999" step="0.0001">
                                        <span class="preset-label">È†êË®≠</span>
                                    </div>
                                    <div class="input-group">
                                        <select disabled>
                                            <option selected>Equity to Liability</option>
                                        </select>
                                        <input type="number" placeholder="Ëº∏ÂÖ•Êï∏ÂÄº" min="0.0000" max="999.9999" step="0.0001">
                                        <span class="preset-label">È†êË®≠</span>
                                    </div>
                                </div>
                                <button type="button" class="add-field-btn" id="add-field-btn">+ Êñ∞Â¢ûÊ¨Ñ‰Ωç</button>
                            </div>
                        </div>

                        <!-- Ê™îÊ°à‰∏äÂÇ≥ÂçÄÂüü -->
                        <div id="file-input" style="display: none;">
                            <div class="form-item">
                                <label>‰∏äÂÇ≥Ë≤°ÂãôÊï∏ÊìöÊ™îÊ°à:</label>
                                <input type="file" accept=".csv, .xlsx, .json" id="file-upload">
                            </div>
                        </div>

                        <!-- Threshold Ë®≠ÂÆö -->
                        <div class="form-item">
                            <label>Ë®≠ÂÆö Threshold:</label>
                            <div class="threshold-description">
                                ‰Ω†ÊÉ≥Ë¶ÅÊõ¥„Äå‰øùÂÆà„ÄçÈÇÑÊòØÊõ¥„ÄåÂö¥Ê†º„ÄçÔºü
                            </div>
                            <div class="threshold-container">
                                <input type="range" id="threshold" min="0.001" max="1.000" step="0.001" value="0.500">
                            </div>
                            <p id="threshold-value" class="mt-2">ÁõÆÂâçÂÄº: 0.500</p>
                            <div id="threshold-info" class="threshold-info">
                                <i class="threshold-icon">‚öñÔ∏è</i>
                                <div class="threshold-info-content">
                                    <div class="threshold-info-title">È¢®Èö™Ë©ï‰º∞Ê®ôÊ∫ñ</div>
                                    <div class="threshold-info-text">Âπ≥Ë°°ÔºåÊ®ôÊ∫ñÈñæÂÄº</div>
                                    <div class="threshold-info-title">ÈÅ©Áî®Â†¥ÊôØ</div>
                                    <div class="threshold-info-text">Â§ßÂ§öÊï∏ÊáâÁî®ÔºåÊ®ôÊ∫ñÈ¢®Èö™Ë©ï‰º∞</div>
                                </div>
                            </div>
                        </div>
                        <div class="analysis-section">
                            <div class="model-selection">
                                <label for="modelSelect">ÈÅ∏ÊìáÊ®°Âûã:</label>
                                <select id="modelSelect" class="form-control">
                                    <option value="classification">ÂàÜÈ°ûÊ®°Âûã (XGBoost)</option>
                                    <option value="regression">ÂõûÊ≠∏Ê®°Âûã (Stacking)</option>
                                </select>
                            </div>
                        </div>
                        <button type="button" id="submit-btn" class="submit-button">
                            ÈñãÂßãÂàÜÊûê
                        </button>
                    </div>

                    <!-- ÁµêÊûúÈ°ØÁ§∫ÂçÄÂüü -->
                    <div class="form-container">
                        <h2 class="text-xl font-bold mb-4">üìã AI Ë≤°ÂãôÂàÜÊûêÂ†±Âëä</h2>
                        <div id="result-text">
                            Ë´ãËº∏ÂÖ•Êï∏Êìö‰∏¶Êèê‰∫§
                        </div>
                        <!-- Ê∑ªÂä†ÂàÜÊûêÁµêÊûúÈ°ØÁ§∫ÂçÄÂüü -->
                        <div id="analysis-results" style="display: none;">
                            <div id="section0" class="result-section"></div>
                            <div id="section1" class="result-section"></div>
                            <div id="section2" class="result-section"></div>
                            <div id="section3" class="result-section"></div>
                            <div id="section4" class="result-section"></div>
                            <div id="section5" class="result-section"></div>
                        </div>
                        <div class="download-section">
                            <button onclick="downloadAndSaveReport()" class="download-btn">
                                üíæ ‰∏ãËºâÂàÜÊûêÂ†±Âëä
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Ë≤°ÂãôÁü•Ë≠òÂ∞èÊïôÂÆ§ÂçÄÂ°ä -->
                <div id="knowledge" class="content-wrapper" style="display: none;">
                    <div class="welcome-section">
                        <h1>üìö Ë≤°ÂãôÁü•Ë≠òÂ∞èÊïôÂÆ§</h1>
                        <p>ËÆìÊàëÂÄë‰∏ÄËµ∑Â≠∏ÁøíÈáçË¶ÅÁöÑË≤°ÂãôÁü•Ë≠òÔºåÊèêÂçáÊÇ®ÁöÑË≤°ÂãôÊ±∫Á≠ñËÉΩÂäõ„ÄÇ</p>
                    </div>

                    <div class="knowledge-grid">
                        <div class="knowledge-card" style="min-height: 300px;">
                            <h2 class="text-2xl font-bold mb-4">Ë≤°ÂãôÂ†±Ë°®Âü∫Á§éÁü•Ë≠ò</h2>
                            <p style="margin-bottom: 20px;">Ë≤°ÂãôÂ†±Ë°®ÊòØ‰ºÅÊ•≠Á∂ìÁáüÊàêÊûúÁöÑÂ±ïÁèæÔºåÈÄèÈÅéÂàÜÊûêË≤°ÂãôÂ†±Ë°®ÔºåÊàëÂÄëÂèØ‰ª•‰∫ÜËß£‰ºÅÊ•≠ÁöÑÁáüÈÅãÊïàÁéá„ÄÅÁç≤Âà©ËÉΩÂäõËàáÈ¢®Èö™„ÄÇ</p>
                            <ul class="mt-4 list-disc list-inside" style="line-height: 2;">
                                <li>Ë≥áÁî¢Ë≤†ÂÇµË°®ÔºöÂèçÊò†‰ºÅÊ•≠Âú®ÁâπÂÆöÊôÇÈªûÁöÑË≤°ÂãôÁãÄÊ≥ÅÔºåÂåÖÂê´Ë≥áÁî¢„ÄÅË≤†ÂÇµÂíåËÇ°Êù±Ê¨äÁõä‰∏âÂ§ßÈ†ÖÁõÆ</li>
                                <li>ÊêçÁõäË°®ÔºöÈ°ØÁ§∫‰∏ÄÊÆµÊôÇÈñìÂÖßÁöÑÁ∂ìÁáüÊàêÊûúÔºåÂåÖÊã¨Êî∂ÂÖ•„ÄÅÊàêÊú¨„ÄÅË≤ªÁî®ÂíåÂà©ÊΩ§Á≠âÈ†ÖÁõÆ</li>
                                <li>ÁèæÈáëÊµÅÈáèË°®ÔºöË®òÈåÑÁèæÈáëÁöÑÊî∂ÂÖ•ÂíåÊîØÂá∫ÊÉÖÊ≥ÅÔºåÂàÜÁÇ∫ÁáüÊ•≠„ÄÅÊäïË≥áÂíåÁ±åË≥á‰∏âÂ§ßÊ¥ªÂãï</li>
                                <li>ËÇ°Êù±Ê¨äÁõäËÆäÂãïË°®ÔºöËøΩËπ§ËÇ°Êú¨„ÄÅÁõàÈ§òÂàÜÈÖçÁ≠âËÆäÂãïÔºåÂëàÁèæ‰ºÅÊ•≠Ë≥áÊú¨ÁµêÊßãÊºîËÆä</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Ë≤°Â†±ÊØîÁéáË™™ÊòéÈÅ∏ÊìáÂçÄÂ°ä -->
                    <div class="knowledge-card mb-8" style="margin-bottom: 60px !important;">
                        <h2 class="text-2xl font-bold mb-4">Ë≤°ÂãôÊØîÁéáÊü•Ë©¢Â∑•ÂÖ∑</h2>
                        <p style="margin-bottom: 20px;">ËóâÁî±‰∏äËø∞Ë≤°Â†±‰∏≠ÁöÑÊï∏ÊìöÈÄ≤Ë°åÊï∏Â≠∏ÈÅãÁÆóÔºåË©ï‰º∞‰ºÅÊ•≠Ë≤°ÂãôÁµêÊßã„ÄÅÁ∂ìÁáüÊïàÁéáÂíåÂÑüÂÇµËÉΩÂäõÁ≠âÊåáÊ®ô„ÄÇ</p>
                        <div class="form-group">
                            <select class="form-select w-full p-2 border rounded" id="financialMetric">
                                <option value="">Ë´ãÈÅ∏ÊìáË≤°ÂãôÊåáÊ®ô...</option>
                            </select>
                        </div>
                        <div class="result-section mt-4" id="resultSection" style="display: none;">
                            <h3 class="text-xl font-bold text-blue-600">ÊåáÊ®ôË©≥Á¥∞Ë≥áË®ä</h3>
                            <div class="mt-4">
                                <p class="font-bold">ÊåáÊ®ôÂàÜÈ°ûÔºö</p>
                                <p id="metricCategory" class="mb-2"></p>
                                <p class="font-bold">ÊåáÊ®ôÊèèËø∞Ôºö</p>
                                <p id="metricDescription" class="mb-2"></p>
                                <p class="font-bold">Ë®àÁÆóÂÖ¨ÂºèÔºö</p>
                                <div id="metricFormula" class="p-2 bg-gray-100 rounded mb-2"></div>
                                <p class="font-bold">ÂêàÁêÜÁØÑÂúçÔºö</p>
                                <div id="metricRange" class="p-2 bg-blue-50 rounded"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ê≠∑Âè≤Êï∏ÊìöÂçÄÂ°ä -->
                <div id="history" class="content-wrapper" style="display: none;">
                    <div class="welcome-section">
                        <h1>üìä Ê≠∑Âè≤ÂàÜÊûêË®òÈåÑ</h1>
                        <div id="history-welcome" style="display: none; text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                            <p style="font-size: 1.2em; font-weight: bold;">Ê≠°Ëøé‰ΩøÁî®Ë≤°ÂãôÂàÜÊûêÁ≥ªÁµ±</p>
                            <p>ÊÇ®ÈÇÑÊ≤íÊúâ‰ªª‰ΩïÂàÜÊûêË®òÈåÑ„ÄÇÊÇ®ÂèØ‰ª•Ôºö</p>
                            <ul style="list-style-type: none; padding: 0;">
                                <li>‚úÖ ‰∏äÂÇ≥Ë≤°ÂãôÊï∏ÊìöÊ™îÊ°àÈÄ≤Ë°åÂàÜÊûê</li>
                                <li>‚úÖ ÊâãÂãïËº∏ÂÖ•Ë≤°ÂãôÊåáÊ®ôÈÄ≤Ë°åÂàÜÊûê</li>
                                <li>‚úÖ Êü•ÁúãÂàÜÊûêÂ†±ÂëäÂíåÂª∫Ë≠∞</li>
                            </ul>
                        </div>
                    </div>
                    <div id="history-content" style="display: none;">
                        <!-- Ê≠∑Âè≤Ë®òÈåÑÂÖßÂÆπÂ∞áÂú®ÈÄôË£°ÂãïÊÖãÈ°ØÁ§∫ -->
                    </div>
                </div>
                

                <!-- ËÅØÁµ°ÊàëÂÄëÂçÄÂ°ä -->
                <div id="contact" class="content-wrapper" style="display: none;">
                    <div class="welcome-section">
                        <h1>üìß ËÅØÁµ°ÊàëÂÄë</h1>
                        <p>Â¶ÇÊúâ‰ªª‰ΩïÂïèÈ°åÊàñÂª∫Ë≠∞ÔºåÊ≠°ËøéËàáÊàëÂÄëËÅØÁπ´„ÄÇ</p>
                    </div>
                    <div class="form-container">
                        <form id="contactForm" onsubmit="handleSubmit(event)">
                            <div class="input-group">
                                <span class="preset-label">ÂßìÂêç</span>
                                <input type="text" id="name" name="name" required>
                            </div>

                            <div class="input-group">
                                <span class="preset-label">‰ø°ÁÆ±</span>
                                <input type="email" id="email" name="email" required>
                            </div>

                            <div class="input-group">
                                <span class="preset-label">‰∏ªÊó®</span>
                                <input type="text" id="subject" name="subject" required>
                            </div>

                            <div class="input-group">
                                <span class="preset-label">ÂÖßÂÆπ</span>
                                <textarea id="message" name="message" rows="5" required style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid #e2e8f0;"></textarea>
                            </div>

                            <button type="submit" class="submit-button" style="margin-top: 20px;">ÈÄÅÂá∫Ë®äÊÅØ</button>
                        </form>
                    </div>

                    <div class="contact-info" style="margin-top: 30px;">
                        <h2 class="text-xl font-bold">ÂÖ∂‰ªñËÅØÁµ°ÊñπÂºè</h2>
                        <p>üìû ÈõªË©±Ôºö(02) 1234-5678</p>
                        <p>üìß EmailÔºöcontact@example.com</p>
                        <p>üè¢ Âú∞ÂùÄÔºöTibame Âè∞ÂåóÊ†°ÂçÄ</p>
                        <p>‚è∞ ÊúçÂãôÊôÇÈñìÔºöÈÄ±‰∏ÄËá≥ÈÄ±‰∫î 9:00-16:30</p>
                    </div>
                </div>
            </div>

            <!-- Âè≥ÂÅ¥Á©∫ÁôΩÂçÄ -->
            <div class="sidebar-right"></div>
        </div>
    </div>

    <script>
        // È†ÅÈù¢Âä†ËºâÊôÇÈ°ØÁ§∫È¶ñÈ†Å
        window.addEventListener('load', function() {
            // È°ØÁ§∫È¶ñÈ†ÅÂÖßÂÆπ
            const homeSection = document.getElementById('home');
            homeSection.style.display = 'block';
            homeSection.classList.add('active');

            // ÊøÄÊ¥ªÈ¶ñÈ†ÅÂ∞éËà™ÈÄ£Áµê
            document.querySelector('a[href="#home"]').classList.add('active');

            // È°ØÁ§∫ÁâπËâ≤ÂçÄÂ°ä
            const featuresContainer = document.querySelector('.features-container');
            featuresContainer.classList.add('visible');

            // ÂàùÂßãÂåñ AOS
            AOS.init({
                duration: 800,
                once: true
            });
        });

        // Êõ¥Êñ∞ Threshold È°ØÁ§∫ÂíåËÉåÊôØ
        function updateThreshold(value) {
            const threshold = document.getElementById('threshold');
            const percentage = ((value - 0.001) / (1.000 - 0.001)) * 100;
            threshold.style.background = `linear-gradient(to right, #4CAF50 ${percentage}%, #ddd ${percentage}%)`;
            
            // Êõ¥Êñ∞È°ØÁ§∫ÂÄº
            document.getElementById('threshold-value').textContent = `ÁõÆÂâçÂÄº: ${value}`;
            
            // Êõ¥Êñ∞ÊèêÁ§∫‰ø°ÊÅØ
            const thresholdInfo = document.getElementById('threshold-info');
            let icon, title, text, title2, text2;
            
            if (value <= 0.4) {
                icon = '‚ö†Ô∏è';
                title = 'È¢®Èö™Ë©ï‰º∞Ê®ôÊ∫ñ';
                text = '‰øùÂÆàÔºåÂÆπÊòìÊ®ôÁÇ∫È´òÈ¢®Èö™';
                title2 = 'ÈÅ©Áî®Â†¥ÊôØ';
                text2 = 'È¢®Èö™ÂÅèÂ•ΩËºÉ‰ΩéÔºåÂ∏åÊúõÈ†êË≠¶Êõ¥ÈùàÊïè';
            } else if (value <= 0.7) {
                icon = '‚öñÔ∏è';
                title = 'È¢®Èö™Ë©ï‰º∞Ê®ôÊ∫ñ';
                text = 'Âπ≥Ë°°ÔºåÊ®ôÊ∫ñÈñæÂÄº';
                title2 = 'ÈÅ©Áî®Â†¥ÊôØ';
                text2 = 'Â§ßÂ§öÊï∏ÊáâÁî®ÔºåÊ®ôÊ∫ñÈ¢®Èö™Ë©ï‰º∞';
            } else {
                icon = 'üéØ';
                title = 'È¢®Èö™Ë©ï‰º∞Ê®ôÊ∫ñ';
                text = 'Âö¥Ê†ºÔºåÊ∏õÂ∞ëË™§Â†±È´òÈ¢®Èö™';
                title2 = 'ÈÅ©Áî®Â†¥ÊôØ';
                text2 = 'È¢®Èö™ÂÆπÂøçÂ∫¶ËºÉÈ´òÔºåÈÅøÂÖçË™§Âà§';
            }
            
            thresholdInfo.innerHTML = `
                <i class="threshold-icon">${icon}</i>
                <div class="threshold-info-content">
                    <div class="threshold-info-title">${title}</div>
                    <div class="threshold-info-text">${text}</div>
                    <div class="threshold-info-title">${title2}</div>
                    <div class="threshold-info-text">${text2}</div>
                </div>
            `;
        }

        // Áõ£ËÅΩ Threshold ËÆäÂåñ
        document.getElementById('threshold').addEventListener('input', function() {
            updateThreshold(this.value);
        });

        // ÂàùÂßãÂåñ Threshold
        updateThreshold(0.500);

        // ‰øÆÊîπÂ∞éËà™ËôïÁêÜÂáΩÊï∏
        function handleNavigation(targetId) {
            // ÁßªÈô§ÊâÄÊúâÂ∞éËà™ÈÄ£ÁµêÁöÑÊ¥ªÂãïÁãÄÊÖã
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // ÁÇ∫Áï∂ÂâçÈÅ∏‰∏≠ÁöÑÂ∞éËà™Ê∑ªÂä†Ê¥ªÂãïÁãÄÊÖã
            document.querySelector(`a[href="#${targetId}"]`).classList.add('active');
            
            // Èö±ËóèÊâÄÊúâÂÖßÂÆπÂçÄÂüü
            document.querySelectorAll('.content-wrapper').forEach(section => {
                section.style.display = 'none';
                section.classList.remove('active');
            });

            // È°ØÁ§∫ÁõÆÊ®ôÂÖßÂÆπÂçÄÂüü
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.style.display = 'block';
                setTimeout(() => {
                    targetSection.classList.add('active');
                    // Â¶ÇÊûúÊòØÊ≠∑Âè≤Êï∏ÊìöÈ†ÅÈù¢ÔºåÂâáËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑ
                    if (targetId === 'history') {
                        loadHistory();
                    }
                }, 10);
            }
        }

        // ÈñãÂßãÂàÜÊûêÊåâÈàïÈªûÊìä‰∫ã‰ª∂
        function navigateToAnalysis() {
            handleNavigation('analysis');
        }

        // Â∞éËà™ÈªûÊìä‰∫ã‰ª∂
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                handleNavigation(targetId);
            });
        });

        // ‰øÆÊîπÂàÜÊûêÁµêÊûúËôïÁêÜÂáΩÊï∏
        function handlePredictionResult(data) {
            try {
                console.log("Êî∂Âà∞ÂàÜÊûêÁµêÊûú:", data);
                
                // ÁîüÊàêÁµêÊûúÊñáÊú¨
                const resultText = document.getElementById('result-text');
                resultText.innerHTML = '';
                
                if (data.error) {
                    resultText.innerHTML = `<div class="error-message">ÈåØË™§: ${data.error}</div>`;
                    return;
                }
                
                // ÂâµÂª∫ÁµêÊûúÂÆπÂô®
                const resultContainer = document.createElement('div');
                resultContainer.className = 'result-container';
                
                // Ê∑ªÂä†È†êÊ∏¨ÁµêÊûú
                const predictionClass = data.prediction >0.5 ? 'healthy' : 'unhealthy';
                const predictionResult = data.prediction >0.5  ? 'Ë≤°ÂãôÂÅ•Â∫∑' : 'ÂèØËÉΩÁ†¥Áî¢';
                
                resultText.appendChild(resultContainer);
                
                // È°ØÁ§∫sectionÂÖßÂÆπ
                if (data.sections) {
                    console.log("ËôïÁêÜsectionsÊï∏Êìö:", Object.keys(data.sections));
                    // È°ØÁ§∫ÂàÜÊûêÁµêÊûúÂçÄÂüü
                    const analysisResultsDiv = document.getElementById('analysis-results');
                    analysisResultsDiv.style.display = 'block'; // ÊîπÁÇ∫ block ‰ª•ÈÅ©ÊáâÂÆπÂô®‰ΩàÂ±Ä
                    analysisResultsDiv.innerHTML = ''; // Ê∏ÖÁ©∫ÁèæÊúâÂÖßÂÆπ
                    
                    // ‰æùÊ¨°ËôïÁêÜÊØèÂÄãsection
                    for (let i = 0; i <= 5; i++) {
                        const sectionData = data.sections[`section_${i}`];
                        if (!sectionData) {
                            console.warn(`Áº∫Â∞ësection_${i}Êï∏Êìö`);
                            continue;
                        }
                        
                        console.log(`ËôïÁêÜsection_${i}:`, sectionData);
                        
                        // ÂâµÂª∫sectionÂÖÉÁ¥†
                        const sectionDiv = document.createElement('div');
                        sectionDiv.id = `section${i}`;
                        sectionDiv.className = 'result-section';
                        
                        // ÂâµÂª∫Ê®ôÈ°å
                        const titleH2 = document.createElement('h2');
                        titleH2.className = 'analysis-title';
                        
                        // ÁæéÂåñÊ®ôÈ°å
                        let titleText = sectionData.title || `ÂàÜÊûêÁµêÊûú ${i+1}`;
                        // ÁßªÈô§SECTIONÂâçÁ∂¥
                        titleText = titleText.replace(/^SECTION\s*\d+\s*/i, '');
                        
                        if (i === 0) {
                            titleText = 'Ê®°ÂûãË≥áË®ä';
                        } else if (titleText.trim() === '') {
                            // ÁÇ∫Á©∫Ê®ôÈ°åÊ∑ªÂä†ÈªòË™çÂÄº
                            const defaultTitles = [
                                'Ê®°ÂûãË≥áË®ä',
                                'Êï¥È´îÁµ±Ë®àÁöÑÊï∏ÊìöËàáÊåáÊ®ôÂàÜÊûê',
                                'Â∞çÈÄô‰∫õÊåáÊ®ôÁöÑË©≥Á¥∞Ëß£Èáã',
                                'ÈáùÂ∞çÂèØËÉΩÁ†¥Áî¢‰ºÅÊ•≠ÁöÑÂÖ∑È´îÊîπÂñÑÂª∫Ë≠∞',
                                'Âª∫Ë≠∞ÁöÑÂæåÁ∫åÂàÜÊûêÊñπÂêë',
                                'Ê≥®ÊÑè‰∫ãÈ†Ö'
                            ];
                            titleText = defaultTitles[i] || `ÂàÜÊûêÁµêÊûú ${i+1}`;
                        }
                        
                        titleH2.textContent = titleText;
                        
                        // ÂâµÂª∫ÂÖßÂÆπÂÆπÂô®
                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'result-content';
                        
                        // ËôïÁêÜ‰∏çÂêåÈ°ûÂûãÁöÑÂÖßÂÆπ
                        let contentHtml = '';
                        const content = sectionData.content;
                        
                        if (i === 0 && typeof content === 'object') {
                            // Section 0 ÁâπÊÆäËôïÁêÜ
                            contentHtml = `
                                <p><strong>È†êÊ∏¨ÁµêÊûú:</strong> ${content.prediction || 'ÁÑ°Êï∏Êìö'}</p>
                                <p><strong>Ë≤°ÂãôÂÅ•Â∫∑Â∫¶:</strong> ${content.financial_health || 'ÁÑ°Êï∏Êìö'}</p>
                                <p><strong>Ê∫ñÁ¢∫Áéá:</strong> ${content.accuracy || 'ÁÑ°Êï∏Êìö'}</p>
                                <p><strong>Á≤æÁ¢∫Áéá:</strong> ${content.precision || 'ÁÑ°Êï∏Êìö'}</p>
                                <p><strong>Âè¨ÂõûÁéá:</strong> ${content.recall || 'ÁÑ°Êï∏Êìö'}</p>
                                <p><strong>F1ÂàÜÊï∏:</strong> ${content.f1_score || 'ÁÑ°Êï∏Êìö'}</p>
                                ${content.analysis ? `<div class="analysis-content">${formatContent(content.analysis)}</div>` : ''}
                            `;
                        
                        } else {
                            // ÂÖ∂‰ªñsectionËôïÁêÜÂÖßÂÆπÊ†ºÂºè
                            contentHtml = formatContent(content) || 'ÁÑ°Êï∏Êìö';
                        }
                        
                        contentDiv.innerHTML = contentHtml;
                        
                        // ÁµÑË£ùsection
                        sectionDiv.appendChild(titleH2);
                        sectionDiv.appendChild(contentDiv);
                        
                        // Ê∑ªÂä†Âà∞ÁµêÊûúÂçÄÂüü
                        analysisResultsDiv.appendChild(sectionDiv);
                    }
                    
                    // Á¢∫‰øùÂè™Âú®Ë≤°ÂãôÂàÜÊûêÈ†ÅÈù¢È°ØÁ§∫ÁµêÊûú
                    const analysisSection = document.getElementById('analysis');
                    analysisSection.style.display = 'block';
                    
                    // ÊªæÂãïÂà∞ÁµêÊûúÂçÄÂüü
                    resultText.scrollIntoView({ behavior: 'smooth' });
                } else {
                    console.warn("ÂõûÊáâ‰∏≠Áº∫Â∞ësectionsÊï∏Êìö");
                    document.getElementById('analysis-results').style.display = 'none';
                }
            } catch (error) {
                console.error("ËôïÁêÜÂàÜÊûêÁµêÊûúÊôÇÂá∫ÈåØ:", error);
                const resultText = document.getElementById('result-text');
                resultText.innerHTML = `<div class="error-message">ËôïÁêÜÁµêÊûúÊôÇÁôºÁîüÈåØË™§: ${error.message}</div>`;
            }
        }
        
        // Ê†ºÂºèÂåñÂÖßÂÆπÔºåÂÑ™ÂåñÊÆµËêΩÂíåÊ®ôÈ°å
        function formatContent(content) {
            if (!content) return '';
            
            let formattedContent = content;
            
            // Â∞áÂ∏∏Ë¶ãÁöÑÊ®ôÈ°åÊ®°ÂºèÊõøÊèõÁÇ∫Â∏∂Ê®£ÂºèÁöÑÊ®ôÈ°å
            formattedContent = formattedContent.replace(/^\s*([‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅ1-9][\.„ÄÅÔºéÔºö:][^<>\n]{3,})/gm, '<strong>$1</strong>');
            formattedContent = formattedContent.replace(/^\s*([A-Z][\.„ÄÅÔºéÔºö:])/gm, '<strong>$1</strong>');
            
            // Â∞áÂÜíËôüÂæåÈù¢ÁöÑÈáçË¶Å‰ø°ÊÅØË®≠ÁÇ∫ËóçËâ≤
            formattedContent = formattedContent.replace(/(Ôºö|:)([^<>\n]{1,30})(„ÄÇ|\.|Ôºå|,|\n)/g, '$1<span style="color:#4a69bd;">$2</span>$3');
            
            // Â∞áÊï∏Â≠óÁôæÂàÜÊØîÂä†Á≤ó
            formattedContent = formattedContent.replace(/(\d+(\.\d+)?%)/g, '<strong>$1</strong>');
            
            // ÊõøÊèõÊèõË°åÁ¨¶ÁÇ∫ÊÆµËêΩ
            formattedContent = formattedContent.replace(/\n\s*\n/g, '</p><p>');
            formattedContent = formattedContent.replace(/\n/g, '<br>');
            
            // Á¢∫‰øùÊï¥ÂÄãÂÖßÂÆπË¢´ÊÆµËêΩÂåÖË£π
            if (!formattedContent.startsWith('<p>')) {
                formattedContent = '<p>' + formattedContent;
            }
            if (!formattedContent.endsWith('</p>')) {
                formattedContent = formattedContent + '</p>';
            }
            
            return formattedContent;
        }

        // ÁßªÈô§Ëá™Âãï‰∏ãËºâÁöÑÈÉ®ÂàÜ
        function showResults(data) {
            const resultText = document.getElementById('result-text');
            // ... È°ØÁ§∫ÁµêÊûúÁöÑ‰ª£Á¢º ...
            
            // Ê∑ªÂä†‰∏ãËºâÊåâÈàï
            const downloadButton = document.createElement('button');
            downloadButton.className = 'download-btn';
            downloadButton.textContent = '‰∏ãËºâÂ†±Âëä';
            downloadButton.onclick = downloadAndSaveReport;
            resultText.appendChild(downloadButton);
        }

        async function downloadAndSaveReport() {
            try {
                // Áç≤ÂèñË¶ÅÊà™ÂúñÁöÑÂÖÉÁ¥† - ÂåÖÊã¨ÁµêÊûúÊñáÊú¨ÂíåÂàÜÊûêÁµêÊûú
                const resultContainer = document.createElement('div');
                resultContainer.style.background = '#ffffff';
                resultContainer.style.padding = '20px';
                resultContainer.style.borderRadius = '10px';
                
                // Ë§áË£ΩÁµêÊûúÊñáÊú¨
                const resultText = document.getElementById('result-text').cloneNode(true);
                resultContainer.appendChild(resultText);
                
                // Ë§áË£ΩÂàÜÊûêÁµêÊûúÂçÄÂüü
                if (document.getElementById('analysis-results').style.display !== 'none') {
                    const analysisResults = document.getElementById('analysis-results').cloneNode(true);
                    analysisResults.style.display = 'block';
                    resultContainer.appendChild(analysisResults);
                }
                
                // Êö´ÊôÇÊ∑ªÂä†Âà∞ÊñáÊ™î‰ª•‰æøÊà™Âúñ
                resultContainer.style.position = 'absolute';
                resultContainer.style.left = '-9999px';
                document.body.appendChild(resultContainer);
                
                // Áç≤ÂèñÂàÜÊûêÁµêÊûú
                let prediction = 0;
                let financialHealth = 0.5;
                
                // ÂòóË©¶ÂæûÁµêÊûú‰∏≠Áç≤ÂèñÂÄº
                try {
                    const resultContent = document.querySelector('.result-content');
                    console.dir(resultContent);

                    if (resultContent) {
                        prediction = resultContent.textContent.includes('Ë≤°ÂãôÂÅ•Â∫∑') ? 0 : 1;
                        
                        // Áõ¥Êé•ÂæûÊ®°ÂûãË≥áË®ä‰∏≠Áç≤ÂèñË≤°ÂãôÂÅ•Â∫∑Â∫¶
                        const modelInfo = document.querySelector('#section0 .result-content');
                        console.dir(modelInfo);
                        const match = modelInfo ? modelInfo.textContent.match(/Ë≤°ÂãôÂÅ•Â∫∑Â∫¶[:Ôºö]?\s*([\d.]+)%/) : null;
                        console.log(match.textContent);
                        financialHealth = match && !isNaN(match[1]) ? parseFloat(match[1]) / 100 : null;
                        if (financialHealth === null) {
                            const apiResponse = await fetch('/financial_health');
                            const apiData = await apiResponse.json();
                            financialHealth = apiData.financial_health || 0.5;
                        }
                        alert(financialHealth)
                    }
                } catch (e) {
                    console.error('Ëß£ÊûêÁµêÊûúÊï∏ÊìöÊôÇÂá∫ÈåØ:', e);
                }
                
                // ‰ΩøÁî® html2canvas Êà™Âúñ
                const canvas = await html2canvas(resultContainer, {
                    scale: 2,
                    backgroundColor: '#ffffff',
                    logging: false,
                    useCORS: true
                });
                
                // ÁßªÈô§Êö´ÊôÇÊ∑ªÂä†ÁöÑÂÖÉÁ¥†
                document.body.removeChild(resultContainer);
                
                // ÂÖà‰øùÂ≠òÂà∞‰º∫ÊúçÂô®
                const response = await fetch('/save-history', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        imageData: canvas.toDataURL('image/png'),
                        prediction: prediction,
                        financial_health: financialHealth
                    })
                });

                const result = await response.json();
                
                if (result.status === 'success') {
                    // ÊàêÂäü‰øùÂ≠òÂæåÂÜç‰∏ãËºâ
                    const link = document.createElement('a');
                    link.download = `Ë≤°ÂãôÂàÜÊûêÂ†±Âëä_${new Date().toLocaleDateString().replace(/\//g, '-')}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                    
                    alert('ÂàÜÊûêÂ†±ÂëäÂ∑≤ÊàêÂäü‰∏ãËºâ');
                } else {
                    throw new Error(result.message || '‰øùÂ≠òÂ§±Êïó');
                }
            } catch (error) {
                console.error('‰∏ãËºâÂ†±ÂëäÊôÇÁôºÁîüÈåØË™§:', error);
                alert('‰∏ãËºâÂ†±ÂëäÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶');
            }
        }

        // Êî∂ÈõÜËº∏ÂÖ•Êï∏ÊìöÁöÑËºîÂä©ÂáΩÊï∏
        function collectInputData() {
            const inputs = document.querySelectorAll('#fields-container .input-group');
            return Array.from(inputs).map(group => {
                const select = group.querySelector('select');
                const input = group.querySelector('input');
                return {
                    indicator: select.value || select.options[0].text,
                    value: input.value
                };
            });
        }

        // ‰øÆÊîπÈ°ØÁ§∫Ê≠∑Âè≤Ë®òÈåÑÁöÑÂáΩÊï∏
        async function loadHistory() {
            try {
                const response = await fetch('/get-history');
                const data = await response.json();
                
                const historyContent = document.getElementById('history-content');
                const historyWelcome = document.getElementById('history-welcome');
                
                if (!data || data.is_empty || !data.history || data.history.length === 0) {
                    historyContent.style.display = 'none';
                    historyWelcome.style.display = 'block';
                    historyWelcome.innerHTML = `
                        <div class="welcome-message">
                            <h3>Ê≠°Ëøé‰ΩøÁî®Ë≤°ÂãôÂàÜÊûêÁ≥ªÁµ±</h3>
                            <p>ÁõÆÂâçÈÇÑÊ≤íÊúâÂàÜÊûêË®òÈåÑ„ÄÇÊÇ®ÂèØ‰ª•Ôºö</p>
                            <ul>
                                <li>‰∏äÂÇ≥Ê™îÊ°àÈÄ≤Ë°åÂàÜÊûê</li>
                                <li>ÊâãÂãïËº∏ÂÖ•Êï∏ÊìöÈÄ≤Ë°åÂàÜÊûê</li>
                            </ul>
                        </div>
                    `;
                    return;
                }
                
                historyContent.style.display = 'block';
                historyWelcome.style.display = 'none';
                
                const historyList = document.createElement('div');
                historyList.className = 'history-grid';
                
                data.history.forEach(record => {
                    const recordCard = document.createElement('div');
                    recordCard.className = 'history-card';
                    recordCard.dataset.filename = record.filename; // Ê∑ªÂä† data-filename Â±¨ÊÄß‰ª•‰æøÂæåÁ∫åÈÅ∏Êìá
                    recordCard.innerHTML = `
                        <div class="history-card-header">
                            <h3 class="analysis-date">ÂàÜÊûêÂ†±Âëä ${new Date(record.timestamp).toLocaleDateString()}</h3>
                        </div>
                        <div class="history-card-content">
                            <div class="history-info">
                                <p class="financial-health">Ë≤°ÂãôÂÅ•Â∫∑Â∫¶Ôºö${(record.financial_health * 100).toFixed(2)}%</p>
                                <p class="prediction ${record.prediction >0.5 ? 'healthy' : 'unhealthy'}">
                                    È†êÊ∏¨ÁµêÊûúÔºö${record.prediction >0.5 ? 'Ë≤°ÂãôÂÅ•Â∫∑' : 'ÂèØËÉΩÁ†¥Áî¢'}
                                </p>
                            </div>
                            <button onclick="deleteRecord('${record.filename}')" class="delete-btn">
                                <i class="fas fa-trash"></i> Âà™Èô§Ë®òÈåÑ
                            </button>
                        </div>
                    `;
                    historyList.appendChild(recordCard);
                });
                
                historyContent.innerHTML = '';
                historyContent.appendChild(historyList);
                
            } catch (error) {
                console.error('ËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§:', error);
                const historyContent = document.getElementById('history-content');
                const historyWelcome = document.getElementById('history-welcome');
                historyContent.style.display = 'none';
                historyWelcome.style.display = 'block';
                historyWelcome.innerHTML = `
                    <div class="error-message">
                        <h3>ËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§</h3>
                        <p>Ë´ãÁ®çÂæåÂÜçË©¶„ÄÇÂ¶ÇÊûúÂïèÈ°åÊåÅÁ∫åÂ≠òÂú®ÔºåË´ãËÅØÁπ´Á≥ªÁµ±ÁÆ°ÁêÜÂì°„ÄÇ</p>
                    </div>
                `;
            }
        }

        // Á¢∫‰øùÂú®ÂàáÊèõÂà∞Ê≠∑Âè≤È†ÅÈù¢ÊôÇËºâÂÖ•Êï∏Êìö
        document.addEventListener('DOMContentLoaded', function() {
            const historyLink = document.querySelector('a[href="#history"]');
            if (historyLink) {
                historyLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    handleNavigation('history');
                    loadHistory();
                });
            }
        });

        // Ê∑ªÂä†Á≥ªÁµ±Ê™¢Êü•ÂáΩÊï∏
        async function checkHistorySystem() {
            try {
                const response = await fetch('/debug-history');
                const data = await response.json();
                console.log('Á≥ªÁµ±ÁãÄÊÖã:', data);
                alert(JSON.stringify(data, null, 2));
            } catch (error) {
                console.error('Ê™¢Êü•Á≥ªÁµ±ÁãÄÊÖãÊôÇÁôºÁîüÈåØË™§:', error);
                alert('Ê™¢Êü•Â§±Êïó: ' + error.message);
            }
        }

        // Ê∑ªÂä†‰∏ãËºâÁ¢∫Ë™çÂáΩÊï∏
        function confirmDownload(filename) {
            console.log('Ê∫ñÂÇô‰∏ãËºâ:', filename);
            return true;
        }

        // ‰øÆÊîπ‰∏ãËºâÊ≠∑Âè≤Â†±ÂëäÁöÑÂáΩÊï∏
        async function downloadHistoryReport(filename) {
            try {
                // ÂâµÂª∫‰∏ÄÂÄãËá®ÊôÇÁöÑ a Ê®ôÁ±§
                const link = document.createElement('a');
                link.href = `/static/history_data/${filename}`;
                link.download = `Ë≤°ÂãôÂàÜÊûêÂ†±Âëä_${new Date().toISOString().replace(/[:.]/g, '-')}.png`;
                
                // Ê∑ªÂä†Âà∞ÊñáÊ™î‰∏≠‰∏¶Ëß∏ÁôºÈªûÊìä
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                console.error('‰∏ãËºâÂ†±ÂëäÊôÇÁôºÁîüÈåØË™§:', error);
                alert('‰∏ãËºâÂ†±ÂëäÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶');
            }
        }

        // ‰øÆÊîπÂà™Èô§Ë®òÈåÑÁöÑÂáΩÊï∏
        async function deleteHistoryRecord(filename) {
            if (!confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÁ≠ÜË®òÈåÑÂóéÔºü')) {
                return;
            }

            try {
                const response = fetch('/delete-history', {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ filename })
                });

                const data = response.json();
                if (data.status === 'success') {
                    alert('Ë®òÈåÑÂ∑≤ÊàêÂäüÂà™Èô§');
                    loadHistory();
                } else {
                    alert('Âà™Èô§Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§Ôºö' + data.message);
                }
            } catch (error) {
                console.error('Âà™Èô§Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§:', error);
                alert('Âà™Èô§Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§');
            }
        }

        // ‰øÆÊîπ‰∏ÄÈçµÂà™Èô§ÊâÄÊúâË®òÈåÑÁöÑÂáΩÊï∏
        async function deleteAllRecords() {
            try {
                if (!confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÊâÄÊúâË®òÈåÑÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÊÅ¢Âæ©ÔºÅ')) {
                    return;
                }
                
                // Á´ãÂç≥Âæû UI ÁßªÈô§ÊâÄÊúâË®òÈåÑÂç°Áâá
                const historyCards = document.querySelectorAll('.history-card');
                historyCards.forEach(card => {
                    card.style.transition = 'opacity 0.3s, transform 0.3s';
                    card.style.opacity = '0';
                    card.style.transform = 'scale(0.9)';
                });
                
                // Ë®≠ÁΩÆÂª∂ÈÅ≤ÂæåÊ∏ÖÁ©∫Ê≠∑Âè≤ÂÖßÂÆπÔºåÈ°ØÁ§∫Ê≠°ËøéË®äÊÅØ
                setTimeout(() => {
                    const historyContent = document.getElementById('history-content');
                    const historyWelcome = document.getElementById('history-welcome');
                    
                    historyContent.style.display = 'none';
                    historyWelcome.style.display = 'block';
                    historyWelcome.innerHTML = `
                        <div class="welcome-message">
                            <h3>Ê≠°Ëøé‰ΩøÁî®Ë≤°ÂãôÂàÜÊûêÁ≥ªÁµ±</h3>
                            <p>ÁõÆÂâçÈÇÑÊ≤íÊúâÂàÜÊûêË®òÈåÑ„ÄÇÊÇ®ÂèØ‰ª•Ôºö</p>
                            <ul>
                                <li>‰∏äÂÇ≥Ê™îÊ°àÈÄ≤Ë°åÂàÜÊûê</li>
                                <li>ÊâãÂãïËº∏ÂÖ•Êï∏ÊìöÈÄ≤Ë°åÂàÜÊûê</li>
                            </ul>
                        </div>
                    `;
                }, 300);
                
                // Âú®ËÉåÊôØËôïÁêÜÂà™Èô§Ë´ãÊ±Ç
                const response = await fetch('/delete-all-records', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (!result.success) {
                    console.error(`API ÂõûÂÇ≥Âà™Èô§ÊâÄÊúâË®òÈåÑÂ§±Êïó: ${result.message || 'Êú™Áü•ÈåØË™§'}`);
                }
            } catch (error) {
                console.error('Âà™Èô§ÊâÄÊúâË®òÈåÑÊôÇÁôºÁîüÈåØË™§:', error);
                alert('Âà™Èô§ËôïÁêÜÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§ÔºåÊ≠£Âú®ÈáçÊñ∞ËºâÂÖ•');
                // ÈáçÊñ∞ËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑ‰ª•Á¢∫‰øù UI ËàáÂæåÁ´ØÂêåÊ≠•
                await loadHistory();
            }
        }

        // ‰øÆÊîπËº∏ÂÖ•ÊñπÂºèÈÅ∏ÊìáÁöÑ‰∫ã‰ª∂Áõ£ËÅΩ
        document.getElementById('inputMethod').addEventListener('change', function() {
            const manualInput = document.getElementById('manual-input');
            const fileInput = document.getElementById('file-input');
            
            if (this.value === 'manual') {
                manualInput.style.display = 'block';
                fileInput.style.display = 'none';
            } else {
                manualInput.style.display = 'none';
                fileInput.style.display = 'block';
            }
        });

        // ÂàùÂßãÂåñÂ∑≤‰ΩøÁî®ÁöÑË≤°ÂãôÊåáÊ®ôÂàóË°®
        let usedIndicators = [
            'Net Income to Total Assets', 
            "Net Income to Stockholder's Equity", 
            'Equity to Liability'
        ];

        // ÊâÄÊúâÂèØÁî®ÁöÑË≤°ÂãôÊåáÊ®ô
        const allIndicators = [
            'Operating Gross Margin', 
            'Tax rate (A)', 
            'Net Value Per Share (A)', 
            'Persistent EPS in the Last Four Seasons', 
            'Cash Flow Per Share',
            'Revenue Per Share (Yuan ¬•)', 
            'After-tax Net Profit Growth Rate',
            'Quick Ratio',
            'Total debt/Total net worth', 
            'Debt ratio %', 
            'Contingent liabilities/Net worth',
            'Inventory and accounts receivable/Net value',
            'Total Asset Turnover', 
            'Operating profit per person', 
            'Allocation rate per person',
            'Working Capital to Total Assets',
            'Quick Assets/Total Assets',
            'Current Assets/Total Assets', 
            'Cash/Total Assets', 
            'Cash/Current Liability',
            'Operating Funds to Liability', 
            'Working Capital/Equity',
            'Long-term Liability to Current Assets', 
            'Total expense/Assets', 
            'Fixed Assets to Assets', 
            'Equity to Long-term Liability', 
            'Cash Flow to Total Assets',
            'Cash Flow to Liability',
            'CFO to Assets',
            'Cash Flow to Equity', 
            'Current Liability to Current Assets',
            'Liability-Assets Flag', 
            'Net Income to Total Assets', 
            "Net Income to Stockholder's Equity", 
            'Equity to Liability'

        ];

        // ËÅØÁµ°Ë°®ÂñÆÊèê‰∫§ËôïÁêÜ
        async function handleSubmit(event) {
            event.preventDefault();
            
            // Á¶ÅÁî®Êèê‰∫§ÊåâÈàïÔºåÈÅøÂÖçÈáçË§áÈªûÊìä
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'ÂàÜÊûê‰∏≠...';
            submitBtn.style.background = '#6c757d';
            
            try {
                const inputMethod = document.getElementById('inputMethod').value;
                const threshold = document.getElementById('threshold').value;

                if (inputMethod === 'file') {
                    const fileInput = document.getElementById('file-upload');
                    const file = fileInput.files[0];
                    
                    if (!file) {
                        alert('Ë´ãÈÅ∏ÊìáÊ™îÊ°à');
                        return;
                    }
                    
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('threshold', threshold);
                    
                    const response = await fetch('/submit-file', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error(`‰º∫ÊúçÂô®ÈåØË™§ (${response.status})`);
                    }
                    
                    const data = await response.json();
                    handlePredictionResult(data);
                } else {
                    // ÊâãÂãïËº∏ÂÖ•Ê®°Âºè
                    const indicators = [];
                    let hasInvalidInput = false;
                    
                    // Êî∂ÈõÜÊâÄÊúâËº∏ÂÖ•Ê¨Ñ‰ΩçÁöÑÂÄºÔºåÂåÖÊã¨È†êË®≠Ê¨Ñ‰Ωç
                    document.querySelectorAll('#fields-container .input-group').forEach(field => {
                        const select = field.querySelector('select');
                        const input = field.querySelector('input');
                        
                        if (select && input && input.value) {
                            const value = parseFloat(input.value);
                            if (value >= 0.0000 && value <= 999.9999) {
                                indicators.push({
                                    indicator: select.value || select.options[0].text,
                                    value: value
                                });
                            } else {
                                hasInvalidInput = true;
                                alert(`Ë´ãÁ¢∫‰øù ${select.value || select.options[0].text} ÁöÑÊï∏ÂÄºÂú®0.0000Âà∞999.9999‰πãÈñì`);
                            }
                        }
                    });

                    if (hasInvalidInput) {
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'ÈñãÂßãÂàÜÊûê';
                        submitBtn.style.background = '#28a745';
                        return;
                    }
                    
                    if (document.getElementById('inputMethod').value == 'manual') {
                        if (indicators.length < 3) {
                            alert("Ë´ãËá≥Â∞ëËº∏ÂÖ•3ÂÄãÊåáÊ®ôÁöÑÊï∏ÂÄºÔºàÂåÖÂê´È†êË®≠Ê¨Ñ‰ΩçÔºâÔºÅ");
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'ÈñãÂßãÂàÜÊûê';
                            submitBtn.style.background = '#28a745';
                            return;
                        }
                    }

                    const response = await 
                    fetch('/submit', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            indicators: indicators,
                            threshold: parseFloat(threshold)
                        })
                    });

                    const data = await response.json();
                    handlePredictionResult(data);
                }
            } catch (error) {
                console.error('Êèê‰∫§ÈåØË™§:', error);
                alert('Êèê‰∫§ÊôÇÁôºÁîüÈåØË™§: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'ÈñãÂßãÂàÜÊûê';
                submitBtn.style.background = '#28a745';
            }
        }

        // ÂàùÂßãÂåñÈ†ÅÈù¢ÊôÇÊ∑ªÂä†‰∫ã‰ª∂Áõ£ËÅΩÂô®
        document.addEventListener('DOMContentLoaded', function() {
            // È°ØÁ§∫È¶ñÈ†Å
            handleNavigation('home');
            
            // ÂàùÂßãÂåñ AOS
            AOS.init({
                duration: 800,
                once: true
            });

            // ÂàùÂßãÂåñ Threshold
            updateThreshold(0.500);

            // Âä†ËºâÊ≠∑Âè≤Ë®òÈåÑ
            loadHistory();

            // Á∂ÅÂÆöÊñ∞Â¢ûÊ¨Ñ‰ΩçÊåâÈàï‰∫ã‰ª∂
            const addFieldBtn = document.getElementById('add-field-btn');
            if (addFieldBtn) {
                addFieldBtn.addEventListener('click', addNewField);
            }
            
            // Á∂ÅÂÆöÊèê‰∫§ÊåâÈàï‰∫ã‰ª∂
            const submitBtn = document.getElementById('submit-btn');
            if (submitBtn) {
                submitBtn.addEventListener('click', handleSubmit);
            }
            
            // Á∂ÅÂÆöÈ†êË®≠Ê¨Ñ‰ΩçÁöÑËº∏ÂÖ•È©óË≠â
            const inputs = document.querySelectorAll('#fields-container input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    validateInput(this);
                });
            });

            // Á∂ÅÂÆöÈñãÂßãÂàÜÊûêÊåâÈàï‰∫ã‰ª∂
            const ctaButton = document.querySelector('.cta-button');
            if (ctaButton) {
                ctaButton.addEventListener('click', function() {
                    handleNavigation('analysis');
                });
            }

            // Á∂ÅÂÆöÂ∞éËà™ÈÄ£Áµê‰∫ã‰ª∂
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    handleNavigation(targetId);
                });
            });

            // Á∂ÅÂÆö Threshold ‰∫ã‰ª∂
            const thresholdInput = document.getElementById('threshold');
            if (thresholdInput) {
                thresholdInput.addEventListener('input', function() {
                    updateThreshold(this.value);
                });
            }

            // Á∂ÅÂÆöËº∏ÂÖ•ÊñπÂºèÈÅ∏Êìá‰∫ã‰ª∂
            const inputMethod = document.getElementById('inputMethod');
            if (inputMethod) {
                inputMethod.addEventListener('change', function() {
                    const manualInput = document.getElementById('manual-input');
                    const fileInput = document.getElementById('file-input');
                    
                    if (this.value === 'manual') {
                        manualInput.style.display = 'block';
                        fileInput.style.display = 'none';
                    } else {
                        manualInput.style.display = 'none';
                        fileInput.style.display = 'block';
                    }
                });
            }

            // ‰øÆÊîπÈ†ÅÈù¢ÂØ¨Â∫¶Ê®£Âºè
            const welcomeSections = document.querySelectorAll('.welcome-section');
            welcomeSections.forEach(section => {
                section.style.maxWidth = '600px';
            });
        });
           // Áç≤ÂèñÊ®°ÂûãÈÅ∏Êìá‰∏ãÊãâÂºèÈÅ∏ÂñÆ
           const modelSelect = document.getElementById('modelSelect');
           
           // Áõ£ËÅΩÊ®°ÂûãÈÅ∏ÊìáÁöÑËÆäÂåñ
           modelSelect.addEventListener('change', function() {
               const selectedModel = this.value;
               console.log('ÈÅ∏ÊìáÁöÑÊ®°Âûã:', selectedModel);
               // ÈÄôË£°ÂèØ‰ª•Ê∑ªÂä†Ê†πÊìöÈÅ∏ÊìáÁöÑÊ®°ÂûãÈÄ≤Ë°åÁõ∏ÊáâËôïÁêÜÁöÑ‰ª£Á¢º
           });


           // ‰øÆÊîπÊèê‰∫§ÊåâÈàïÁöÑÈªûÊìä‰∫ã‰ª∂ËôïÁêÜ
           document.getElementById('submit-btn').addEventListener('click', function() {
                const selectedModel = modelSelect.value;
                const indicators = [];
                const inputGroups = document.querySelectorAll('.input-group');
                
                inputGroups.forEach(group => {
                   const select = group.querySelector('select');
                   const input = group.querySelector('input');
                   if (select && input && input.value) {
                       indicators.push({
                           indicator: select.value,
                           value: parseFloat(input.value)
                       });
                   }
               });
                const fileInput = document.etElementById('fileInput');
                const file = fileInput.files[0];
                if (!file) {
                    alert('Ë´ãÈÅ∏ÊìáË¶Å‰∏äÂÇ≥ÁöÑÊ™îÊ°à');
                    return;
                }
                // Á¢∫‰øù file ÊòØÊúâÊïàÁöÑÊ™îÊ°à
                const validFileTypes = ['text/csv', 'application/json', 'application/vnd.ms-excel'];
                if (!validFileTypes.includes(file.type)) {
                    alert('Ê™îÊ°àÊ†ºÂºèÈåØË™§ÔºåË´ãÈÅ∏Êìá CSV Êàñ JSON Ê™îÊ°à');
                    return;
                }
                const inputMethodValue = document.getElementById('inputMethod').value;
                if (inputMethodValue == 'manual') {
                        if (indicators.length < 3) {
                            alert('Ë´ãËá≥Â∞ëËº∏ÂÖ•3ÂÄãÊåáÊ®ô');
                            return;
                        };
                };               
           });

        // Êñ∞Â¢ûÊ¨Ñ‰ΩçÂáΩÊï∏
        function addNewField() {
            const container = document.getElementById('fields-container');
            const availableIndicators = allIndicators.filter(ind => !usedIndicators.includes(ind));
            
            if (availableIndicators.length === 0) {
                alert('Â∑≤‰ΩøÁî®ÊâÄÊúâÂèØÁî®ÁöÑË≤°ÂãôÊåáÊ®ô');
                return;
            }

            const fieldDiv = document.createElement('div');
            fieldDiv.className = 'input-group';
            
            const select = document.createElement('select');
            select.innerHTML = '<option value="">ÈÅ∏ÊìáË≤°ÂãôÊåáÊ®ô</option>' +
                availableIndicators.map(ind => `<option value="${ind}">${ind}</option>`).join('');
            
            const input = document.createElement('input');
            input.type = 'number';
            input.placeholder = 'Ëº∏ÂÖ•Êï∏ÂÄº';
            input.min = '0.0000';
            input.max = '999.9999';
            input.step = '0.0001';
            input.pattern = '[0-9]*[.,]?[0-9]{0,4}';
            input.oninput = function() { validateInput(this); };
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'preset-label';
            removeBtn.style.background = '#dc3545';
            removeBtn.innerHTML = 'Âà™Èô§';
            removeBtn.onclick = function() {
                const selectedValue = select.value;
                if (selectedValue) {
                    const index = usedIndicators.indexOf(selectedValue);
                    if (index > -1) {
                        usedIndicators.splice(index, 1);
                    }
                }
                container.removeChild(fieldDiv);
            };

            select.onchange = function() {
                const selectedValue = this.value;
                if (selectedValue) {
                    usedIndicators.push(selectedValue);
                }
            };

            fieldDiv.appendChild(select);
            fieldDiv.appendChild(input);
            fieldDiv.appendChild(removeBtn);
            container.appendChild(fieldDiv);
        }

        // È©óË≠âËº∏ÂÖ•ÂÄº
        function validateInput(input) {
            let value = input.value.replace(/[^0-9.]/g, '');
            let parts = value.split('.');
            
            // Â§ÑÁêÜÊï¥Êï∞ÈÉ®ÂàÜ
            if (parts[0].length > 3) {
                parts[0] = parts[0].slice(0, 3);
            }
            
            // Â§ÑÁêÜÂ∞èÊï∞ÈÉ®ÂàÜ
            if (parts.length > 1) {
                if (parts[1].length > 4) {
                    parts[1] = parts[1].slice(0, 4);
                }
                value = parts[0] + '.' + parts[1];
            } else {
                value = parts[0];
            }
            
            // ËΩ¨Êç¢‰∏∫Êï∞ÂÄºÂπ∂È™åËØÅËåÉÂõ¥
            let numValue = parseFloat(value);
            if (!isNaN(numValue)) {
                numValue = Math.max(0, Math.min(999.9999, numValue));
                input.value = numValue.toFixed(4);
            } else {
                input.value = '';
            }
        }

        // Ê∑ªÂä†‰∏ÄÂÄãÊ™¢Êü•ÊåâÈàïÂà∞Ê≠∑Âè≤Êï∏ÊìöÈ†ÅÈù¢
        async function checkSystem() {
            try {
                const response = await fetch('/check-system');
                const data = await response.json();
                console.log('Á≥ªÁµ±Ê™¢Êü•ÁµêÊûú:', data);
                alert(JSON.stringify(data, null, 2));
            } catch (error) {
                console.error('Ê™¢Êü•ÊôÇÁôºÁîüÈåØË™§:', error);
                alert('Ê™¢Êü•Â§±Êïó: ' + error);
            }
        }

        // Âú®Ê≠∑Âè≤Êï∏ÊìöÈ†ÅÈù¢Ê∑ªÂä†Ê™¢Êü•ÊåâÈàï
        function loadHistory() {
            // ... ÂéüÊúâ‰ª£Á¢º ...
            let historyHTML = `
                <div class="history-container">
                    <button onclick="checkSystem()" class="check-btn" style="margin-right: 10px;">
                        Ê™¢Êü•Á≥ªÁµ±
                    </button>
                    <button onclick="deleteAllRecords()" class="delete-all-btn">
                        Âà™Èô§ÊâÄÊúâË®òÈåÑ
                    </button>
                    <div class="history-records">`;
            // ... ÂéüÊúâ‰ª£Á¢º ...
        }

        // Ê∑ªÂä†Èô§ÈåØ‰ø°ÊÅØÈ°ØÁ§∫ÂáΩÊï∏
        async function showDebugInfo() {
            try {
                const response = await fetch('/debug-history');
                const debugInfo = await response.json();
                const debugDiv = document.getElementById('debug-info');
                debugDiv.style.display = debugDiv.style.display === 'none' ? 'block' : 'none';
                debugDiv.innerHTML = `<pre>${JSON.stringify(debugInfo, null, 2)}</pre>`;
            } catch (error) {
                console.error('Áç≤ÂèñÈô§ÈåØ‰ø°ÊÅØÂ§±Êïó:', error);
            }
        }

        // Ë≤°ÂãôÊåáÊ®ôÊï∏Êìö
        const financialMetrics = {
            // 1. Total debt/Total net worth (Á∏ΩË≤†ÂÇµÂ∞çÊ∑®ÂÄºÊØîÁéá)
            total_debt_total_net_worth: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ê∏¨ÈáèÂÖ¨Âè∏Á∏ΩË≤†ÂÇµÂ∞çËÇ°Êù±Ê¨äÁõäÁöÑÊØî‰æãÔºåË°°ÈáèÂÇµÊ¨ä‰∫∫ËàáËÇ°Êù±Âú®‰ºÅÊ•≠ËûçË≥á‰∏≠ÁöÑÁõ∏Â∞çÂú∞‰ΩçÔºåÂèçÊò†Ë≤°ÂãôÊßìÊ°øÊ∞¥Âπ≥„ÄÇ",
                formula: "Á∏ΩË≤†ÂÇµ √∑ Ê∑®ÂÄº",
                range: "0.3 ~ 0.6"
            },
            // 2. Debt ratio % (Ë≤†ÂÇµÊØîÁéá%)
            debt_ratio_percent: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Á∏ΩË≤†ÂÇµÂç†Á∏ΩË≥áÁî¢ÁöÑÁôæÂàÜÊØîÔºåË°°ÈáèÂÖ¨Âè∏Ë≥áÁî¢‰∏≠ÊúâÂ§öÂ∞ëÊØî‰æãÊòØÁî±ÂÇµÊ¨ä‰∫∫Êèê‰æõÁöÑË≥áÈáëÊâÄÊîØÊåÅÁöÑ„ÄÇ",
                formula: "Á∏ΩË≤†ÂÇµ √∑ Á∏ΩË≥áÁî¢ √ó 100%",
                range: "30% ~ 60%"
            },
            // 3. Net worth/Assets (Ê∑®ÂÄºÂ∞çË≥áÁî¢ÊØîÁéá)
            net_worth_assets: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "ËÇ°Êù±Ê¨äÁõäÂç†Á∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåÂèàÁ®±Ëá™ÊúâË≥áÈáëÊØîÁéáÔºåÂèçÊò†ÂÖ¨Âè∏ÁöÑË≤°ÂãôÁç®Á´ãÊÄßËàáÊäµÁ¶¶È¢®Èö™ÁöÑËÉΩÂäõ„ÄÇ",
                formula: "Ê∑®ÂÄº √∑ Á∏ΩË≥áÁî¢",
                range: "40% ~ 70%"
            },
            // 4. Long-term fund suitability ratio (A) (Èï∑ÊúüË≥áÈáëÈÅ©ÂêàÁéáA)
            long_term_fund_suitability_ratio_a: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë©ï‰º∞Èï∑ÊúüË≥áÈáë(ËÇ°Êù±Ê¨äÁõäËàáÈï∑ÊúüË≤†ÂÇµ)Â∞çÈï∑ÊúüË≥áÁî¢ÁöÑË¶ÜËìãÁ®ãÂ∫¶ÔºåÂèçÊò†ÂÖ¨Âè∏Èï∑ÊúüË≥áÈáë‰æÜÊ∫êËàáÈÅãÁî®ÁöÑÂåπÈÖçÊÄß„ÄÇ",
                formula: "(Ê¨äÁõä+Èï∑ÊúüË≤†ÂÇµ) √∑ (Âõ∫ÂÆöË≥áÁî¢+Èï∑ÊúüÊäïË≥á)",
                range: "0.8 ~ 1.2"
            },
            // 5. Borrowing dependency (ÂÄüÊ¨æ‰æùÂ≠òÂ∫¶)
            borrowing_dependency: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë°°ÈáèÂÖ¨Âè∏Â∞çÂ§ñÈÉ®ÂÄüÊ¨æÁöÑ‰æùË≥¥Á®ãÂ∫¶ÔºåË®àÁÆóÁ∏ΩÂÄüÊ¨æÂç†Á∏ΩË≥áÁî¢ÁöÑÊØîÈáçÔºåÂèçÊò†‰ºÅÊ•≠ËûçË≥áÁµêÊßã‰∏≠ÁöÑÂÄüÊ¨æÊàêÂàÜ„ÄÇ",
                formula: "Á∏ΩÂÄüÊ¨æ √∑ Á∏ΩË≥áÁî¢",
                range: "0.2 ~ 0.5"
            },
            // 6. Net Value Per Share (A) (ÊØèËÇ°Ê∑®ÂÄºA)
            net_value_per_share_a: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "ÊØèËÇ°ÊâÄ‰ª£Ë°®ÁöÑËÇ°Êù±Ê¨äÁõäÈáëÈ°çÔºåÂèçÊò†ÂÖ¨Âè∏ÊØèËÇ°ËÇ°Á•®ÁöÑÂ∏≥Èù¢ÂÉπÂÄºÔºåÊòØÊäïË≥áËÄÖË©ï‰º∞ËÇ°Á•®ÂÖßÂú®ÂÉπÂÄºÁöÑÂü∫Êú¨ÊåáÊ®ô„ÄÇ",
                formula: "ËÇ°Êù±Ê¨äÁõä √∑ ÊµÅÈÄöÂú®Â§ñËÇ°Êï∏",
                range: "È´òÊñºÈù¢ÂÄº‰∏îÁ©©ÂÆöÊàêÈï∑ÁÇ∫‰Ω≥"
            },
            // 7. Net Value Per Share (B) (ÊØèËÇ°Ê∑®ÂÄºB)
            net_value_per_share_b: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "ÊØèËÇ°ÊâÄ‰ª£Ë°®ÁöÑÊúâÂΩ¢Ë≥áÁî¢Ê∑®ÂÄºÔºåÂç≥Êâ£Èô§ÁÑ°ÂΩ¢Ë≥áÁî¢ÂæåÁöÑÊØèËÇ°Ê∑®ÂÄºÔºåÊõ¥ÂÅ¥ÈáçÊñºË©ï‰º∞ÂÖ¨Âè∏ÁöÑÂØ¶Ë≥™Ë≥áÁî¢ÊîØÊåÅ„ÄÇ",
                formula: "ÊúâÂΩ¢Ë≥áÁî¢Ê∑®ÂÄº √∑ ÊµÅÈÄöÂú®Â§ñËÇ°Êï∏",
                range: "È´òÊñºÈù¢ÂÄº‰∏îÁ©©ÂÆöÊàêÈï∑ÁÇ∫‰Ω≥"
            },
            // 8. Net Value Per Share (C) (ÊØèËÇ°Ê∑®ÂÄºC)
            net_value_per_share_c: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "ÊØèËÇ°ÊâÄ‰ª£Ë°®ÁöÑÊ∑®Ë≥áÁî¢ÂÉπÂÄºÔºåËÄÉÊÖÆ‰∫ÜË≥áÁî¢Èáç‰º∞Â¢ûÂÄºÁ≠âÂõ†Á¥†ÔºåÊèê‰æõÊõ¥Êé•ËøëÂ∏ÇÂ†¥ÂÉπÂÄºÁöÑÊØèËÇ°Ê∑®ÂÄºË©ï‰º∞„ÄÇ",
                formula: "Ê∑®Ë≥áÁî¢ √∑ ÊµÅÈÄöÂú®Â§ñËÇ°Êï∏",
                range: "È´òÊñºÈù¢ÂÄº‰∏îÁ©©ÂÆöÊàêÈï∑ÁÇ∫‰Ω≥"
            },
            // 9. NetValueGrowthRate(Ê∑®ÂÄºÊàêÈï∑Áéá)
            net_value_growth_rate: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë°°ÈáèÂÖ¨Âè∏Ê∑®ÂÄº(ËÇ°Êù±Ê¨äÁõä)ÁöÑÊàêÈï∑ÈÄüÂ∫¶ÔºåÂèçÊò†‰ºÅÊ•≠ÈÄöÈÅéÁïôÂ≠òÊî∂ÁõäÊàñÂ¢ûË≥áÁ≠âÊñπÂºèÂ¢ûÂº∑Ëá™ÊúâË≥áÊú¨ÂØ¶ÂäõÁöÑËÉΩÂäõ„ÄÇ",
                formula: "(Êú¨ÊúüÊ∑®ÂÄº-ÂâçÊúüÊ∑®ÂÄº)√∑ÂâçÊúüÊ∑®ÂÄº",
                range: "0% ~ 20%"
            },
            // 10. Liability to Equity (Ë≤†ÂÇµÂ∞çÊ¨äÁõäÊØîÁéá)
            liability_to_equity: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë°°ÈáèÂÖ¨Âè∏Ë≤†ÂÇµËàáËÇ°Êù±Ê¨äÁõäÁöÑÊØî‰æãÈóú‰øÇÔºåÂèçÊò†‰ºÅÊ•≠ÁöÑË≤°ÂãôÊßìÊ°øÁ®ãÂ∫¶ÂíåÈï∑ÊúüÂÑüÂÇµÈ¢®Èö™ÔºåÊï∏ÂÄºË∂äÈ´òË°®Á§∫Ë≤°ÂãôÈ¢®Èö™Ë∂äÂ§ß„ÄÇ",
                formula: "Á∏ΩË≤†ÂÇµ √∑ Á∏ΩÊ¨äÁõä",
                range: "0.5 ~ 1.0"
            },
            // 11. Equity to Liability (Ê¨äÁõäÂ∞çË≤†ÂÇµÊØîÁéá)
            equity_to_liability: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë©ï‰º∞ËÇ°Êù±Ê¨äÁõäÂ∞çË≤†ÂÇµÁöÑË¶ÜËìãÁ®ãÂ∫¶ÔºåÊòØË≤†ÂÇµÂ∞çÊ¨äÁõäÊØîÁéáÁöÑÂÄíÊï∏ÔºåÈ°ØÁ§∫ÂÖ¨Âè∏Ëá™ÊúâË≥áÈáëÂ∞çÂ§ñÈÉ®ÂÄüÊ¨æÁöÑÊØî‰æãÈóú‰øÇ„ÄÇ",
                formula: "Á∏ΩÊ¨äÁõä √∑ Á∏ΩË≤†ÂÇµ",
                range: "1.0 ~ 2.0"
            },
            // 12. Current Liability to Equity (ÊµÅÂãïË≤†ÂÇµÂ∞çÊ¨äÁõäÊØîÁéá)
            current_liability_to_equity: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ê∏¨ÈáèÂÖ¨Âè∏Áü≠ÊúüË≤†ÂÇµËàáËÇ°Êù±Ê¨äÁõäÁöÑÊØî‰æãÔºåË©ï‰º∞‰ºÅÊ•≠Áü≠ÊúüÂÑüÂÇµÂ£ìÂäõËàáËûçË≥áÁµêÊßãÁöÑÂπ≥Ë°°ÊÄß„ÄÇ",
                formula: "ÊµÅÂãïË≤†ÂÇµ √∑ Á∏ΩÊ¨äÁõä",
                range: "0.2 ~ 0.5"
            },
            // 13. Long-term Liability to Current Assets (Èï∑ÊúüË≤†ÂÇµÂ∞çÊµÅÂãïË≥áÁî¢ÊØîÁéá)
            long_term_liability_to_current_assets: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë°°ÈáèÈï∑ÊúüË≤†ÂÇµËàáÊµÅÂãïË≥áÁî¢ÁöÑÊØî‰æãÈóú‰øÇÔºåÂèçÊò†ÂÖ¨Âè∏‰ΩøÁî®Èï∑ÊúüË≤†ÂÇµÊîØÊåÅÁü≠ÊúüË≥áÁî¢ÁöÑÁ®ãÂ∫¶ÔºåÊï∏ÂÄºÈÅéÈ´òÂèØËÉΩÂ∞éËá¥Ë≥áÈáëÁµêÊßã‰∏çÁï∂„ÄÇ",
                formula: "Èï∑ÊúüË≤†ÂÇµ √∑ ÊµÅÂãïË≥áÁî¢",
                range: "0.1 ~ 0.3"
            },
            // 14. Equity to Long-term Liability (Ê¨äÁõäÂ∞çÈï∑ÊúüË≤†ÂÇµÊØîÁéá)
            equity_to_long_term_liability: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë©ï‰º∞ËÇ°Êù±Ê¨äÁõäÂ∞çÈï∑ÊúüË≤†ÂÇµÁöÑ‰øùÈöúÁ®ãÂ∫¶ÔºåÂèçÊò†ÂÖ¨Âè∏Èï∑ÊúüË≤°ÂãôÊßìÊ°øÁöÑÂÆâÂÖ®ÊÄßÂíåÂÑüÂÇµËÉΩÂäõ„ÄÇ",
                formula: "Á∏ΩÊ¨äÁõä √∑ Èï∑ÊúüË≤†ÂÇµ",
                range: "1.5 ~ 3.0"
            },
            // 15. Fixed Assets to Assets (Âõ∫ÂÆöË≥áÁî¢Â∞çË≥áÁî¢ÊØîÁéá)
            fixed_assets_to_assets: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë°°ÈáèÂõ∫ÂÆöË≥áÁî¢Âú®Á∏ΩË≥áÁî¢‰∏≠ÁöÑÂç†ÊØîÔºåÂèçÊò†ÂÖ¨Âè∏Ë≥áÁî¢ÁµêÊßãÁöÑÂâõÊÄßÁ®ãÂ∫¶ËàáË≥áÁî¢ÈÅãÁî®ÁöÑÂΩàÊÄßÁ©∫Èñì„ÄÇ",
                formula: "Âõ∫ÂÆöË≥áÁî¢ √∑ Á∏ΩË≥áÁî¢",
                range: "‰æùÁî¢Ê•≠ÁâπÊÄßËÄåÁï∞ÔºåË£ΩÈÄ†Ê•≠ËºÉÈ´ò"
            },
            // 16. Liability-Assets Flag (Ë≤†ÂÇµÂ§ßÊñºË≥áÁî¢Ê®ôË®ò)
            liability_assets_flag: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë≤†ÂÇµÊòØÂê¶Ë∂ÖÈÅéË≥áÁî¢ÁöÑË≠¶Á§∫ÊåáÊ®ôÔºåÁÇ∫1ÊôÇË°®Á§∫ÂÖ¨Âè∏Â∑≤ËôïÊñºÊäÄË°ìÊÄßÁ†¥Áî¢ÁãÄÊÖãÔºåÊ∑®ÂÄºÁÇ∫Ë≤†„ÄÇ",
                formula: "Ëã•Ë≤†ÂÇµ>Ë≥áÁî¢ ÂâáÁÇ∫1ÔºõÂê¶ÂâáÁÇ∫0",
                range: "ÊáâÁÇ∫0"
            },
            // 17. Contingent liabilities/Net worth (ÊàñÊúâË≤†ÂÇµÂ∞çÊ∑®ÂÄºÊØîÁéá)
            contingent_liabilities_net_worth: {
                category: "Ë≤°ÂãôÁµêÊßã",
                description: "Ë©ï‰º∞ÊàñÊúâË≤†ÂÇµÂ∞çÂÖ¨Âè∏Ê∑®ÂÄºÁöÑÊΩõÂú®ÂΩ±ÈüøÁ®ãÂ∫¶ÔºåÂèçÊò†Êú™‰æÜÂèØËÉΩÂØ¶ÁèæÁöÑÂÇµÂãôÈ¢®Èö™Â∞çËÇ°Êù±Ê¨äÁõäÁöÑÂ®ÅËÑÖ„ÄÇ",
                formula: "ÊàñÊúâË≤†ÂÇµ √∑ Ê∑®ÂÄº",
                range: "< 0.05"
            },
            // 18. Current Ratio (ÊµÅÂãïÊØîÁéá)
            current_ratio: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë°°Èáè‰ºÅÊ•≠ÊµÅÂãïË≥áÁî¢Â∞çÊµÅÂãïË≤†ÂÇµÁöÑË¶ÜËìãËÉΩÂäõÔºåÊòØË©ï‰º∞Áü≠ÊúüÂÑüÂÇµËÉΩÂäõÁöÑÂü∫Êú¨ÊåáÊ®ôÔºåÂèçÊò†ÂÖ¨Âè∏Áü≠ÊúüË≤°ÂãôÂΩàÊÄß„ÄÇ",
                formula: "ÊµÅÂãïË≥áÁî¢ √∑ ÊµÅÂãïË≤†ÂÇµ",
                range: "1.5 ~ 3.0"
            },
            // 19. Quick Ratio (ÈÄüÂãïÊØîÁéá)
            quick_ratio: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÈÄüÂãïË≥áÁî¢(ÊµÅÂãïË≥áÁî¢Ê∏õÂ≠òË≤®)Â∞çÊµÅÂãïË≤†ÂÇµÁöÑË¶ÜËìãËÉΩÂäõÔºåÊèê‰æõÊõ¥Âö¥Ê†ºÁöÑÁü≠ÊúüÂÑüÂÇµËÉΩÂäõÊ∏¨Ë©¶„ÄÇ",
                formula: "ÈÄüÂãïË≥áÁî¢ √∑ ÊµÅÂãïË≤†ÂÇµ",
                range: "1.0 ~ 2.0"
            },
            // 20. Interest Expense Ratio (Âà©ÊÅØÊîØÂá∫Áéá)
            interest_expense_ratio: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ê∏¨ÈáèÂà©ÊÅØÊîØÂá∫Âç†ÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠Êî∂ÂÖ•‰∏≠ÊúâÂ§öÂ∞ëÊØî‰æãÁî®ÊñºÊîØ‰ªòÂÇµÂãôÊàêÊú¨ÔºåÊï∏ÂÄºË∂ä‰ΩéË∂ä‰Ω≥„ÄÇ",
                formula: "Âà©ÊÅØÊîØÂá∫ √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "3% ~ 10%"
            },
            // 21. Interest-bearing debt interest rate (ÈôÑÊÅØË≤†ÂÇµÂà©Áéá)
            interest_bearing_debt_interest_rate: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÈôÑÊÅØË≤†ÂÇµÁöÑÂπ≥ÂùáÂà©ÁéáÊ∞¥Âπ≥ÔºåÂèçÊò†‰ºÅÊ•≠ÊâÄÊâøÊìîÁöÑÂÇµÂãôËûçË≥áÊàêÊú¨ÔºåÊòØË©ï‰º∞ÂÇµÂãôË≤†ÊìîÁöÑÈáçË¶ÅÊåáÊ®ô„ÄÇ",
                formula: "Âà©ÊÅØË≤ªÁî® √∑ Âπ≥ÂùáÈôÑÊÅØË≤†ÂÇµ",
                range: "4% ~ 8%"
            },
            // 22. Continuous interest rate (after tax) (ÊåÅÁ∫åÊÄßÂà©ÊÅØÊØîÁéá-Á®ÖÂæå)
            continuous_interest_rate_after_tax: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÊåÅÁ∫åÊÄßÁöÑÁ®ÖÂæåÂà©ÊÅØÊîØÂá∫Âç†ÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÊèê‰æõÂ∞çÈï∑ÊúüÂÇµÂãôÊàêÊú¨Ë≤†ÊìîÁöÑË©ï‰º∞„ÄÇ",
                formula: "ÊåÅÁ∫åÊÄßÂà©ÊÅØË≤ªÁî®(Á®ÖÂæå) √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "3% ~ 7%"
            },
            // 23. Current Liability to Assets (ÊµÅÂãïË≤†ÂÇµÂ∞çË≥áÁî¢ÊØîÁéá)
            current_liability_to_assets: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ê∏¨ÈáèÊµÅÂãïË≤†ÂÇµÂç†Á∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåË©ï‰º∞ÂÖ¨Âè∏Áü≠ÊúüÂÑüÂÇµÂ£ìÂäõËàáÁ∏ΩÈ´îË≥áÁî¢ÈÖçÁΩÆÁöÑÈóú‰øÇ„ÄÇ",
                formula: "ÊµÅÂãïË≤†ÂÇµ √∑ Á∏ΩË≥áÁî¢",
                range: "0.3 ~ 0.6"
            },
            // 24. Operating Funds to Liability (ÁáüÈÅãË≥áÈáëÂ∞çË≤†ÂÇµÊØîÁéá)
            operating_funds_to_liability: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÁáüÈÅãË≥áÈáë(ÊµÅÂãïË≥áÁî¢Ê∏õÊµÅÂãïË≤†ÂÇµ)Â∞çÁ∏ΩË≤†ÂÇµÁöÑË¶ÜËìãÁ®ãÂ∫¶ÔºåÂèçÊò†‰ºÅÊ•≠Á∂ìÁáüÊ¥ªÂãïÁî¢ÁîüÁöÑË≥áÈáëÂ∞çÂÇµÂãôÁöÑ‰øùÈöúËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÈÅãË≥áÈáë √∑ Á∏ΩË≤†ÂÇµ",
                range: "0.3 ~ 0.7"
            },
            // 25. Cash/Current Liability (ÁèæÈáëÂ∞çÊµÅÂãïË≤†ÂÇµÊØîÁéá)
            cash_current_liability: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁèæÈáëÂ∞çÊµÅÂãïË≤†ÂÇµÁöÑË¶ÜËìãËÉΩÂäõÔºåÂèçÊò†‰ºÅÊ•≠Áõ¥Êé•Áî®ÊúÄÂÖ∑ÊµÅÂãïÊÄßË≥áÁî¢ÂÑüÈÇÑÁü≠ÊúüÂÇµÂãôÁöÑËÉΩÂäõ„ÄÇ",
                formula: "ÁèæÈáë √∑ ÊµÅÂãïË≤†ÂÇµ",
                range: "0.2 ~ 0.5"
            },
            // 26. QuickAssets/CurrentLiability(ÈÄüÂãïË≥áÁî¢Â∞çÊµÅÂãïË≤†ÂÇµÊØîÁéá)
            quick_assets_current_liability: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë°°Èáè‰ºÅÊ•≠ÈÄüÂãïË≥áÁî¢Â∞çÊµÅÂãïË≤†ÂÇµÁöÑË¶ÜËìãÁ®ãÂ∫¶ÔºåÂèàÁ®±ÈÄüÂãïÊØîÁéáÔºåÂèçÊò†ÊéíÈô§Â≠òË≤®ÂæåÁöÑÁü≠ÊúüÂÑüÂÇµËÉΩÂäõ„ÄÇ",
                formula: "ÈÄüÂãïË≥áÁî¢ √∑ ÊµÅÂãïË≤†ÂÇµ",
                range: "1.0 ~ 1.5"
            },
            // 27. Current Liability to Current Assets (ÊµÅÂãïË≤†ÂÇµÂ∞çÊµÅÂãïË≥áÁî¢ÊØîÁéá)
            current_liability_to_current_assets: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë©ï‰º∞ÊµÅÂãïË≤†ÂÇµÁõ∏Â∞çÊñºÊµÅÂãïË≥áÁî¢ÁöÑÊØî‰æãÔºåÊòØÊµÅÂãïÊØîÁéáÁöÑÂÄíÊï∏ÔºåÊï∏ÂÄºË∂ä‰ΩéË°®Á§∫Áü≠ÊúüÂÑüÂÇµËÉΩÂäõË∂äÂº∑„ÄÇ",
                formula: "ÊµÅÂãïË≤†ÂÇµ √∑ ÊµÅÂãïË≥áÁî¢",
                range: "0.4 ~ 0.7"
            },
            // 28. Current Liabilities/Liability (ÊµÅÂãïË≤†ÂÇµÂ∞çÁ∏ΩË≤†ÂÇµÊØîÁéá)
            current_liabilities_liability: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë°°ÈáèÊµÅÂãïË≤†ÂÇµÂú®Á∏ΩË≤†ÂÇµ‰∏≠ÁöÑÂç†ÊØîÔºåÂèçÊò†ÂÖ¨Âè∏Ë≤†ÂÇµÁµêÊßãÁöÑÊúüÈôêÁµÑÊàêÂíåÁü≠ÊúüÂÑüÂÇµÂ£ìÂäõ„ÄÇ",
                formula: "ÊµÅÂãïË≤†ÂÇµ √∑ Á∏ΩË≤†ÂÇµ",
                range: "0.4 ~ 0.8"
            },
            // 29. Interest Coverage Ratio (Âà©ÊÅØ‰øùÈöúÂÄçÊï∏)
            interest_coverage_ratio: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Á®ÖÊÅØÂâçÂà©ÊΩ§(EBIT)Â∞çÂà©ÊÅØË≤ªÁî®ÁöÑË¶ÜËìãËÉΩÂäõÔºåË©ï‰º∞‰ºÅÊ•≠ÊîØ‰ªòÂÇµÂãôÂà©ÊÅØÁöÑËÉΩÂäõËàáË≤°ÂãôÈ¢®Èö™„ÄÇ",
                formula: "EBIT √∑ Âà©ÊÅØË≤ªÁî®",
                range: "3 ~ 10"
            },
            // 30. No-credit Interval (ÁÑ°‰ø°Áî®ÂçÄÈñì)
            no_credit_interval: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Âú®‰∏çÁç≤ÂæóÊñ∞ÁöÑÂ§ñÈÉ®ËûçË≥áÊÉÖÊ≥Å‰∏ãÔºåÂÉÖ‰æùÈù†ÈÄüÂãïË≥áÁî¢Ê∏õÂéªÊµÅÂãïË≤†ÂÇµÂæåËÉΩÁ∂≠ÊåÅÊ≠£Â∏∏ÈÅãÁáüÁöÑÂ§©Êï∏„ÄÇ",
                formula: "(ÈÄüÂãïË≥áÁî¢-ÊµÅÂãïË≤†ÂÇµ) √∑ ÊØèÊó•ÁáüÈÅãÊîØÂá∫",
                range: "30 ~ 90 Â§©"
            },
            // 31. Degree of Financial Leverage (DFL) (Ë≤°ÂãôÊßìÊ°øÂ∫¶)
            degree_of_financial_leverage: {
                category: "ÂÑüÂÇµËÉΩÂäõ",
                description: "Ë°°ÈáèÁ®ÖÊÅØÂâçÂà©ÊΩ§(EBIT)ËÆäÂãïÂ∞çÊØèËÇ°ÁõàÈ§ò(EPS)ËÆäÂãïÁöÑÂΩ±ÈüøÁ®ãÂ∫¶ÔºåÂèçÊò†ÂÖ¨Âè∏‰ΩøÁî®Ë≤°ÂãôÊßìÊ°øÁöÑÊïèÊÑüÊÄß„ÄÇ",
                formula: "EBITËÆäÂãïÁôæÂàÜÊØî √∑ EPSËÆäÂãïÁôæÂàÜÊØî",
                range: "1.5 ~ 3.0"
            },
            // 32. Operating Expense Rate (ÁáüÊ•≠Ë≤ªÁî®Áéá)
            operating_expense_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÁáüÊ•≠Ë≤ªÁî®Âç†ÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†ÂÖ¨Âè∏Âú®Èä∑ÂîÆ„ÄÅÁÆ°ÁêÜÂíåÁ†îÁôºÁ≠âÊñπÈù¢ÁöÑÊäïÂÖ•Ê∞¥Âπ≥ÂíåÊàêÊú¨ÊéßÂà∂ËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÊ•≠Ë≤ªÁî® √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "10% ~ 25%"
            },
            // 33. Research and development expense rate (Á†îÁôºË≤ªÁî®Áéá)
            research_and_development_expense_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞Á†îÁôºË≤ªÁî®Âç†ÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†ÂÖ¨Âè∏Âú®Áî¢ÂìÅÂíåÊäÄË°ìÂâµÊñ∞ÊñπÈù¢ÁöÑÊäïÂÖ•Âº∑Â∫¶ÂíåÊú™‰æÜÁ´∂Áà≠ÂäõÂª∫Ë®≠„ÄÇ",
                formula: "Á†îÁôºË≤ªÁî® √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "3% ~ 10%"
            },
            // 34. Non-industry income and expenditure/revenue (Ê•≠Â§ñÊî∂ÊîØÂ∞çÁáüÊî∂ÊØî)
            non_industry_income_expenditure_revenue: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÈùûÁáüÊ•≠Êî∂ÊîØÊ∑®È°çÁõ∏Â∞çÊñºÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†ÂÖ¨Âè∏Ê†∏ÂøÉÊ•≠ÂãôÂ§ñÁöÑÊî∂ÁõäÊàñÊêçÂ§±Â∞çÊï¥È´îÁ∂ìÁáüÁöÑÂΩ±Èüø„ÄÇ",
                formula: "Ê•≠Â§ñÊî∂ÊîØÊ∑®È°ç √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "-5% ~ 5%"
            },
            // 35. Revenue Per Share (Yuan Áûº) (ÊØèËÇ°ÁáüÊî∂)
            revenue_per_share: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÊØèËÇ°ËÇ°Á•®ÊâÄÂ∞çÊáâÁöÑÈä∑ÂîÆÊî∂ÂÖ•ÔºåÂèçÊò†ÂÖ¨Âè∏ÂâµÈÄ†Êî∂ÂÖ•ÁöÑËÉΩÂäõÂú®ÊØèËÇ°Â±§Èù¢ÁöÑË°®Áèæ„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âä†Ê¨äÂπ≥ÂùáÊµÅÈÄöËÇ°Êï∏",
                range: "ÊåÅÁ∫åÊàêÈï∑ÁÇ∫‰Ω≥"
            },
            // 36. Total Asset Growth Rate (Á∏ΩË≥áÁî¢ÊàêÈï∑Áéá)
            total_asset_growth_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Á∏ΩË≥áÁî¢ÁöÑÂ¢ûÈï∑ÈÄüÂ∫¶ÔºåÂèçÊò†‰ºÅÊ•≠Ë¶èÊ®°Êì¥ÂºµÂíåË≥áÁî¢Á©çÁ¥ØÁöÑËÉΩÂäõÔºåÊòØË°°ÈáèÊï¥È´îÊàêÈï∑ÊÄßÁöÑÊåáÊ®ô„ÄÇ",
                formula: "(Êú¨ÊúüÁ∏ΩË≥áÁî¢-ÂâçÊúüÁ∏ΩË≥áÁî¢) √∑ ÂâçÊúüÁ∏ΩË≥áÁî¢",
                range: "5% ~ 20%"
            },
            // 37. Total Asset Turnover (Á∏ΩË≥áÁî¢Âë®ËΩâÁéá)
            total_asset_turnover: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÂÖ¨Âè∏Âà©Áî®Á∏ΩË≥áÁî¢ÂâµÈÄ†Èä∑ÂîÆÊî∂ÂÖ•ÁöÑÊïàÁéáÔºåÂèçÊò†Ë≥áÁî¢ÁöÑÊï¥È´îÂà©Áî®ÊïàÁéáÂíåÁÆ°ÁêÜÊïàËÉΩ„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÁ∏ΩË≥áÁî¢",
                range: "0.5 ~ 2.0 Ê¨°"
            },
            // 38. Accounts Receivable Turnover (ÊáâÊî∂Â∏≥Ê¨æÂë®ËΩâÁéá)
            accounts_receivable_turnover: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Êî∂ÂõûÊáâÊî∂Â∏≥Ê¨æÁöÑÈÄüÂ∫¶ÂíåÊïàÁéáÔºåÂèçÊò†‰ºÅÊ•≠‰ø°Áî®ÊîøÁ≠ñÁöÑÂö¥Ë¨πÂ∫¶ÂíåÊáâÊî∂Â∏≥Ê¨æÁÆ°ÁêÜËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÊáâÊî∂Â∏≥Ê¨æ",
                range: "5 ~ 10 Ê¨°"
            },
            // 39. Average Collection Days (Âπ≥ÂùáÊî∂Ê¨æÂ§©Êï∏)
            average_collection_days: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÂæûÈä∑ÂîÆÂà∞Êî∂ÂõûÊáâÊî∂Â∏≥Ê¨æÊâÄÈúÄÁöÑÂπ≥ÂùáÂ§©Êï∏ÔºåÊòØÊáâÊî∂Â∏≥Ê¨æÂë®ËΩâÁéáÁöÑÊôÇÈñìË°®ÈÅîÊñπÂºè„ÄÇ",
                formula: "365 √∑ ÊáâÊî∂Â∏≥Ê¨æÂë®ËΩâÁéá",
                range: "30 ~ 60 Â§©"
            },
            // 40. InventoryTurnoverRate (Â≠òË≤®Âë®ËΩâÁéá)
            inventory_turnover_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Â≠òË≤®Èä∑ÂîÆÂíåÊõ¥Êñ∞ÁöÑÈÄüÂ∫¶ÔºåÂèçÊò†Â≠òË≤®ÁÆ°ÁêÜÊïàÁéáÂíåÂ≠òË≤®ÂïÜÂìÅÁöÑÂ∏ÇÂ†¥Êé•ÂèóÂ∫¶„ÄÇ",
                formula: "Èä∑Ë≤®ÊàêÊú¨√∑Âπ≥ÂùáÂ≠òË≤®",
                range: "4 ~ 8 Ê¨°/Âπ¥"
            },
            // 41. Fixed Assets Turnover Frequency (Âõ∫ÂÆöË≥áÁî¢Âë®ËΩâÁéá)
            fixed_assets_turnover_frequency: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÂÖ¨Âè∏Âà©Áî®Âõ∫ÂÆöË≥áÁî¢ÂâµÈÄ†Èä∑ÂîÆÊî∂ÂÖ•ÁöÑÊïàÁéáÔºåÂèçÊò†Âõ∫ÂÆöË≥áÁî¢ÊäïË≥áÁöÑ‰ΩøÁî®ÊïàÁõäÂíåÁî¢Âá∫ËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÂõ∫ÂÆöË≥áÁî¢",
                range: "1 ~ 3 Ê¨°/Âπ¥"
            },
            // 42. Net Worth Turnover Rate (Ê∑®ÂÄºÂë®ËΩâÁéá)
            net_worth_turnover_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Âà©Áî®ËÇ°Êù±Ê¨äÁõäÂâµÈÄ†Èä∑ÂîÆÊî∂ÂÖ•ÁöÑÊïàÁéáÔºåÂèçÊò†Ëá™ÊúâË≥áÈáëÁöÑ‰ΩøÁî®ÊïàÁõäÂíåÁ∂ìÁáüËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÊ∑®ÂÄº",
                range: "1 ~ 3 Ê¨°/Âπ¥"
            },
            // 43. Revenue per person (‰∫∫ÂùáÁáüÊî∂)
            revenue_per_person: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÊØè‰ΩçÂì°Â∑•ÂâµÈÄ†ÁöÑÂπ≥ÂùáÁáüÊ•≠Êî∂ÂÖ•ÔºåÊòØË©ï‰º∞‰∫∫ÂäõË≥áÊ∫êÁîüÁî¢ÊïàÁéáÂíå‰∫∫ÂùáË≤¢ÁçªÁöÑÈáçË¶ÅÊåáÊ®ô„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âì°Â∑•‰∫∫Êï∏",
                range: "‰æùÁî¢Ê•≠ËÄåÁï∞"
            },
            // 44. Operating profit per person (‰∫∫ÂùáÁáüÊ•≠Âà©ÊΩ§)
            operating_profit_per_person: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÊØè‰ΩçÂì°Â∑•Ë≤¢ÁçªÁöÑÂπ≥ÂùáÁáüÊ•≠Âà©ÊΩ§ÔºåÂèçÊò†‰∫∫ÂäõË≥áÊ∫êÁöÑÂÉπÂÄºÂâµÈÄ†ÊïàÁéáÂíåÁ∂ìÁáüÁÆ°ÁêÜÊ∞¥Âπ≥„ÄÇ",
                formula: "ÁáüÊ•≠Âà©ÊΩ§ √∑ Âì°Â∑•‰∫∫Êï∏",
                range: "‰æùÁî¢Ê•≠ËÄåÁï∞"
            },
            // 45. Allocation rate per person (‰∫∫ÂùáÂàÜÈÖçÁéá)
            allocation_rate_per_person: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÊØè‰ΩçÂì°Â∑•Áç≤ÂæóÁöÑÂπ≥ÂùáÂàÜÈÖçÈ°çÔºåÂèçÊò†‰ºÅÊ•≠Âà©ÊΩ§ÂàÜÈÖçÊîøÁ≠ñÂíåÂì°Â∑•Áç≤ÂæóÁöÑÁ∂ìÊøüÂõûÂ†±Ê∞¥Âπ≥„ÄÇ",
                formula: "ÂàÜÈÖçÁ∏ΩÈ°ç √∑ Âì°Â∑•‰∫∫Êï∏",
                range: "‰æùÁî¢Ê•≠ËÄåÁï∞"
            },
            // 46. Current Asset Turnover Rate (ÊµÅÂãïË≥áÁî¢Âë®ËΩâÁéá)
            current_asset_turnover_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Âà©Áî®ÊµÅÂãïË≥áÁî¢ÂâµÈÄ†Èä∑ÂîÆÊî∂ÂÖ•ÁöÑÊïàÁéáÔºåÂèçÊò†ÊµÅÂãïË≥áÁî¢ÁÆ°ÁêÜÂíåÈÅãÁî®ÁöÑÊïàÁõäÊ∞¥Âπ≥„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÊµÅÂãïË≥áÁî¢",
                range: "1 ~ 3 Ê¨°/Âπ¥"
            },
            // 47. Quick Asset Turnover Rate (ÈÄüÂãïË≥áÁî¢Âë®ËΩâÁéá)
            quick_asset_turnover_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÂÖ¨Âè∏Âà©Áî®ÈÄüÂãïË≥áÁî¢(ÁèæÈáë„ÄÅÁü≠ÊúüÊäïË≥á„ÄÅÊáâÊî∂Â∏≥Ê¨æÁ≠â)ÂâµÈÄ†Èä∑ÂîÆÊî∂ÂÖ•ÁöÑÊïàÁéáÔºåÊèê‰æõÂ∞çÈ´òÊµÅÂãïÊÄßË≥áÁî¢‰ΩøÁî®ÊïàÁéáÁöÑË©ï‰º∞„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÈÄüÂãïË≥áÁî¢",
                range: "1 ~ 2 Ê¨°/Âπ¥"
            },
            // 48. Working capitcal Turnover Rate (ÁáüÈÅãË≥áÈáëÂë®ËΩâÁéá)
            working_capital_turnover_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Âà©Áî®ÁáüÈÅãË≥áÈáë(ÊµÅÂãïË≥áÁî¢Ê∏õÊµÅÂãïË≤†ÂÇµ)ÂâµÈÄ†Èä∑ÂîÆÊî∂ÂÖ•ÁöÑÊïàÁéáÔºåÂèçÊò†ÁáüÈÅãË≥áÈáëÁÆ°ÁêÜÂíåÈÅãÁî®ÊïàÁõä„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÁáüÈÅãË≥áÈáë",
                range: "1 ~ 3 Ê¨°/Âπ¥"
            },
            // 49. Cash Turnover Rate (ÁèæÈáëÂë®ËΩâÁéá)
            cash_turnover_rate: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÂÖ¨Âè∏Âà©Áî®ÁèæÈáëÂâµÈÄ†Èä∑ÂîÆÊî∂ÂÖ•ÁöÑÊïàÁéáÔºåÂèçÊò†ÁèæÈáëË≥áÁî¢ÁöÑÂë®ËΩâÈÄüÂ∫¶Âíå‰ΩøÁî®ÊïàÁõä„ÄÇ",
                formula: "ÁáüÊ•≠Êî∂ÂÖ• √∑ Âπ≥ÂùáÁèæÈáë",
                range: "1 ~ 3 Ê¨°/Âπ¥"
            },
            // 50. Total income/Total expense (Á∏ΩÊî∂ÂÖ•Â∞çÁ∏ΩÊîØÂá∫ÊØîÁéá)
            total_income_total_expense: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Á∏ΩÊî∂ÂÖ•Â∞çÁ∏ΩÊîØÂá∫ÁöÑË¶ÜËìãÁ®ãÂ∫¶ÔºåÂèçÊò†Êï¥È´îÊî∂ÊîØÂπ≥Ë°°ÁãÄÊ≥ÅÂíåÁ∂ìÁáüÊïàÁõäÔºåÊØîÂÄºË∂äÈ´òË°®Á§∫ÊïàÁõäË∂äÂ•Ω„ÄÇ",
                formula: "Á∏ΩÊî∂ÂÖ• √∑ Á∏ΩÊîØÂá∫",
                range: "1.2 ~ 2.0"
            },
            // 51. Total expense/Assets (Á∏ΩÊîØÂá∫Â∞çË≥áÁî¢ÊØîÁéá)
            total_expense_assets: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë°°ÈáèÁ∏ΩÊîØÂá∫Áõ∏Â∞çÊñºÁ∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåÂèçÊò†ÂÖ¨Âè∏Ë≥áÁî¢Âà©Áî®ÈÅéÁ®ã‰∏≠ÁöÑÊàêÊú¨ÊéßÂà∂ËÉΩÂäõÂíåË≤ªÁî®ÁÆ°ÁêÜÊ∞¥Âπ≥„ÄÇ",
                formula: "Á∏ΩÊîØÂá∫ √∑ Á∏ΩË≥áÁî¢",
                range: "0.3 ~ 0.6"
            },
            // 52. Inventory and accounts receivable/Net value (Â≠òË≤®ÂèäÊáâÊî∂Â∏≥Ê¨æÂ∞çÊ∑®ÂÄºÊØîÁéá)
            inventory_accounts_receivable_net_worth: {
                category: "Á∂ìÁáüÁ∏æÊïà",
                description: "Ë©ï‰º∞Â≠òË≤®ÂíåÊáâÊî∂Â∏≥Ê¨æÂêàË®àÈáëÈ°çËàáÊ∑®ÂÄºÁöÑÊØî‰æãÈóú‰øÇÔºåÂèçÊò†ÁáüÈÅãË≥áÈáëÂç†Áî®Ê∞¥Âπ≥ËàáËÇ°Êù±Ê¨äÁõäÁöÑÁõ∏Â∞çÈóú‰øÇ„ÄÇ",
                formula: "(Â≠òË≤®+ÊáâÊî∂Â∏≥Ê¨æ) √∑ Ê∑®ÂÄº",
                range: "0.5 ~ 1.0"
            },
            // 53. ROA(C) before interest and depreciation before interest (Âà©ÊÅØÂíåÊäòËàäÂâçË≥áÁî¢Â†±ÈÖ¨ÁéáC)
            roa_c_before_interest_and_depreciation: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Êú™Êâ£Èô§Âà©ÊÅØÂíåÊäòËàäË≤ªÁî®ÂâçÁöÑÁç≤Âà©ËÉΩÂäõÔºåÂèçÊò†‰ºÅÊ•≠Ë≥áÁî¢ÁöÑÂéüÂßãÂâµÂà©ËÉΩÂäõÔºå‰∏çÂèóË≤°ÂãôÊßìÊ°øÂíåÊäòËàäÊîøÁ≠ñÂΩ±Èüø„ÄÇ",
                formula: "(Á®ÖÂâçÊ∑®Âà©+Âà©ÊÅØË≤ªÁî®+ÊäòËàäË≤ªÁî®) √∑ Âπ≥ÂùáÁ∏ΩË≥áÁî¢",
                range: "5% ~ 15%"
            },
            // 54. ROA(A) before interest and % after tax (Âà©ÊÅØÂâçÁ®ÖÂæåË≥áÁî¢Â†±ÈÖ¨ÁéáA)
            roa_a_before_interest_and_after_tax: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Âú®Êâ£Èô§ÊâÄÂæóÁ®Ö‰ΩÜÊú™Êâ£Èô§Âà©ÊÅØË≤ªÁî®ÂâçÁöÑË≥áÁî¢Áç≤Âà©ËÉΩÂäõÔºåÊéíÈô§Ë≤°ÂãôÊßìÊ°øÂΩ±Èüø‰∏ãÁöÑÁ∂ìÁáüÁ∏æÊïà„ÄÇ",
                formula: "(Á®ÖÂæåÊ∑®Âà©+Âà©ÊÅØË≤ªÁî®√ó(1-Á®ÖÁéá)) √∑ Âπ≥ÂùáÁ∏ΩË≥áÁî¢",
                range: "5% ~ 15%"
            },
            // 55. ROA(B) before interest and depreciation after tax (Âà©ÊÅØÂâçÊäòËàäÂæåÁ®ÖÂæåË≥áÁî¢Â†±ÈÖ¨ÁéáB)
            roa_b_before_interest_and_depreciation_after_tax: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Âú®Êâ£Èô§ÊâÄÂæóÁ®ÖÂíåÊäòËàä‰ΩÜÊú™Êâ£Èô§Âà©ÊÅØË≤ªÁî®ÂâçÁöÑË≥áÁî¢Áç≤Âà©ËÉΩÂäõÔºåÁ∂úÂêàËÄÉÈáèÁ®ÖË≤†ÂíåÊäòËàäÂΩ±ÈüøÂæåÁöÑÁ∏æÊïà„ÄÇ",
                formula: "(Á®ÖÂæåÊ∑®Âà©+Âà©ÊÅØË≤ªÁî®√ó(1-Á®ÖÁéá)+ÊäòËàäË≤ªÁî®) √∑ Âπ≥ÂùáÁ∏ΩË≥áÁî¢",
                range: "5% ~ 15%"
            },
            // 56. Operating Gross Margin (ÁáüÊ•≠ÊØõÂà©Áéá)
            operating_gross_margin: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠ÊØõÂà©ËàáÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠Áî¢ÂìÅÊàñÊúçÂãôÁöÑÂü∫Êú¨Áç≤Âà©ËÉΩÂäõÂíåÊàêÊú¨ÁµêÊßã„ÄÇ",
                formula: "ÁáüÊ•≠ÊØõÂà© √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "20% ~ 40%"
            },
            // 57. Realized Sales Gross Margin (Â∑≤ÂØ¶ÁèæÈä∑ÂîÆÊØõÂà©Áéá)
            realized_sales_gross_margin: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂ∑≤ÂØ¶ÁèæÈä∑ÂîÆÊî∂ÂÖ•‰∏≠ÁöÑÊØõÂà©ÊØî‰æãÔºåÊéíÈô§Êú™ÂØ¶ÁèæÊî∂ÂÖ•ÂΩ±ÈüøÂæåÁöÑÂØ¶Ë≥™ÊØõÂà©Ê∞¥Âπ≥„ÄÇ",
                formula: "Â∑≤ÂØ¶ÁèæÈä∑ÂîÆÊØõÂà© √∑ Â∑≤ÂØ¶ÁèæÁáüÊ•≠Êî∂ÂÖ•",
                range: "15% ~ 35%"
            },
            // 58. Operating Profit Rate (ÁáüÊ•≠Âà©ÁõäÁéá)
            operating_profit_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠Âà©ÁõäËàáÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†Ê†∏ÂøÉÊ•≠ÂãôÁöÑÁç≤Âà©ËÉΩÂäõÂíåÁ∂ìÁáüÊïàÁéá„ÄÇ",
                formula: "ÁáüÊ•≠Âà©Áõä √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "10% ~ 25%"
            },
            // 59. Pre-tax net Interest Rate (Á®ÖÂâçÊ∑®Âà©Áéá)
            pre_tax_net_interest_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Á®ÖÂâçÊ∑®Âà©ËàáÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÁ∂úÂêàËÄÉÈáèÁáüÊ•≠ÂíåÈùûÁáüÊ•≠È†ÖÁõÆÂæåÁöÑÊï¥È´îÁç≤Âà©ËÉΩÂäõ„ÄÇ",
                formula: "Á®ÖÂâçÊ∑®Âà© √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "10% ~ 20%"
            },
            // 60. After-tax net Interest Rate (Á®ÖÂæåÊ∑®Âà©Áéá)
            after_tax_net_interest_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Á®ÖÂæåÊ∑®Âà©ËàáÁáüÊ•≠Êî∂ÂÖ•ÁöÑÊØî‰æãÔºåÊòØÊúÄÁµÇÂèçÊò†‰ºÅÊ•≠Áç≤Âà©ËÉΩÂäõÁöÑÈáçË¶ÅÊåáÊ®ô„ÄÇ",
                formula: "Á®ÖÂæåÊ∑®Âà© √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "8% ~ 15%"
            },
            // 61. PersistentEPSintheLastFourSeasons (ÊúÄËøëÂõõÂ≠£ÊåÅÁ∫åÊÄßEPS)
            persistent_eps_last_four_seasons: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÊúÄËøëÂõõÂÄãÂ≠£Â∫¶ÁöÑÊåÅÁ∫åÊÄßÊØèËÇ°ÁõàÈ§òÔºåÊéíÈô§ÈùûÁ∂ìÂ∏∏ÊÄßÈ†ÖÁõÆÂΩ±ÈüøÂæåÁöÑÊ†∏ÂøÉÁç≤Âà©ËÉΩÂäõ„ÄÇ",
                formula: "ÊúÄËøëÂõõÂ≠£ÁöÑÊåÅÁ∫åÊÄßÁ®ÖÂæåÊ∑®Âà© √∑ Âä†Ê¨äÂπ≥ÂùáÊµÅÈÄöËÇ°Êï∏",
                range: "Ê≠£ÂÄº‰∏îÁ©©ÂÆöÁÇ∫‰Ω≥"
            },
            // 62. Operating Profit Per Share (Yuan Áûº) (ÊØèËÇ°ÁáüÊ•≠Âà©Áõä)
            operating_profit_per_share: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÊØèËÇ°ËÇ°Á•®ÊâÄÂ∞çÊáâÁöÑÁáüÊ•≠Âà©ÁõäÈáëÈ°çÔºåÂèçÊò†ÂÖ¨Âè∏Ê†∏ÂøÉÊ•≠ÂãôÂú®ÊØèËÇ°Â±§Èù¢ÁöÑÁç≤Âà©Ë°®Áèæ„ÄÇ",
                formula: "ÁáüÊ•≠Âà©Áõä √∑ Âä†Ê¨äÂπ≥ÂùáÊµÅÈÄöËÇ°Êï∏",
                range: "Ê≠£ÂÄº‰∏îÁ©©ÂÆöÁÇ∫‰Ω≥"
            },
            // 63. Per Share Net profit before tax (Yuan Áûº) (ÊØèËÇ°Á®ÖÂâçÊ∑®Âà©)
            per_share_net_profit_before_tax: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÊØèËÇ°ÊâÄÂ∞çÊáâÁöÑÁ®ÖÂâçÊ∑®Âà©ÈáëÈ°çÔºåÊèê‰æõÊõ¥ÂÖ®Èù¢ÁöÑÊØèËÇ°Áç≤Âà©Ë©ï‰º∞„ÄÇ",
                formula: "Á®ÖÂâçÊ∑®Âà© √∑ Âä†Ê¨äÂπ≥ÂùáÊµÅÈÄöËÇ°Êï∏",
                range: "Ê≠£ÂÄº‰∏îÁ©©ÂÆöÁÇ∫‰Ω≥"
            },
            // 64. After-tax Net Profit Growth Rate (Á®ÖÂæåÊ∑®Âà©ÊàêÈï∑Áéá)
            after_tax_net_profit_growth_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Á®ÖÂæåÊ∑®Âà©ÁöÑÊàêÈï∑ÈÄüÂ∫¶ÔºåÂèçÊò†‰ºÅÊ•≠Áç≤Âà©ËÉΩÂäõÁöÑÂãïÊÖãËÆäÂåñÂíåÊàêÈï∑ÊΩõÂäõ„ÄÇ",
                formula: "(Êú¨ÊúüÁ®ÖÂæåÊ∑®Âà©-ÂâçÊúüÁ®ÖÂæåÊ∑®Âà©) √∑ ÂâçÊúüÁ®ÖÂæåÊ∑®Âà©",
                range: "5% ~ 20%"
            },
            // 65. Regular Net Profit Growth Rate (Á∂ìÂ∏∏ÊÄßÊ∑®Âà©ÊàêÈï∑Áéá)
            regular_net_profit_growth_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Á∂ìÂ∏∏ÊÄßÊ∑®Âà©(ÊéíÈô§ÈùûÁ∂ìÂ∏∏ÊÄßÈ†ÖÁõÆÂæå)ÁöÑÊàêÈï∑ÈÄüÂ∫¶ÔºåÊõ¥ËÉΩÂèçÊò†Ê†∏ÂøÉÊ•≠ÂãôÁöÑÊåÅÁ∫åÊàêÈï∑ËÉΩÂäõ„ÄÇ",
                formula: "(Êú¨ÊúüÁ∂ìÂ∏∏ÊÄßÊ∑®Âà©-ÂâçÊúüÁ∂ìÂ∏∏ÊÄßÊ∑®Âà©) √∑ ÂâçÊúüÁ∂ìÂ∏∏ÊÄßÊ∑®Âà©",
                range: "5% ~ 20%"
            },
            // 66. Continuous Net Profit Growth Rate (ÊåÅÁ∫åÊÄßÊ∑®Âà©ÊàêÈï∑Áéá)
            continuous_net_profit_growth_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÊåÅÁ∫åÊÄßÊ∑®Âà©ÁöÑÊàêÈï∑ÈÄüÂ∫¶ÔºåÂÅ¥ÈáçÊñºÈï∑ÊúüÁ©©ÂÆöÁöÑÁç≤Âà©ÊàêÈï∑Ë∂®Âã¢ÂàÜÊûê„ÄÇ",
                formula: "(Êú¨ÊúüÊåÅÁ∫åÊÄßÊ∑®Âà©-ÂâçÊúüÊåÅÁ∫åÊÄßÊ∑®Âà©) √∑ ÂâçÊúüÊåÅÁ∫åÊÄßÊ∑®Âà©",
                range: "5% ~ 20%"
            },
            // 67. Total Asset Return Growth Rate Ratio (Á∏ΩË≥áÁî¢Â†±ÈÖ¨ÊàêÈï∑ÁéáÊØî)
            total_asset_return_growth_rate_ratio: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÁ∏ΩË≥áÁî¢Â†±ÈÖ¨ÁéáÁöÑÊàêÈï∑ÈÄüÂ∫¶Áõ∏Â∞çÊñºÁ∏ΩË≥áÁî¢ÊàêÈï∑ÈÄüÂ∫¶ÁöÑÊØî‰æãÔºåË©ï‰º∞Ë≥áÁî¢Êì¥ÂºµÊòØÂê¶Â∏∂‰æÜÁõ∏ÊáâÁöÑÂ†±ÈÖ¨ÊèêÂçá„ÄÇ",
                formula: "Êú¨ÊúüROAÊàêÈï∑Áéá √∑ Á∏ΩË≥áÁî¢ÊàêÈï∑Áéá",
                range: "0.8 ~ 1.2"
            },
            // 68. Operating Profit Growth Rate (ÁáüÊ•≠Âà©ÁõäÊàêÈï∑Áéá)
            operating_profit_growth_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠Âà©ÁõäÁöÑÊàêÈï∑ÈÄüÂ∫¶ÔºåÂèçÊò†Ê†∏ÂøÉÊ•≠ÂãôÁç≤Âà©ËÉΩÂäõÁöÑÊèêÂçáÁ®ãÂ∫¶ÂíåÁôºÂ±ïÂãïÂäõ„ÄÇ",
                formula: "(Êú¨ÊúüÁáüÊ•≠Âà©Áõä-ÂâçÊúüÁáüÊ•≠Âà©Áõä) √∑ ÂâçÊúüÁáüÊ•≠Âà©Áõä",
                range: "5% ~ 20%"
            },
            // 69. Realized Sales Gross Profit Growth Rate (Â∑≤ÂØ¶ÁèæÈä∑ÂîÆÊØõÂà©ÊàêÈï∑Áéá)
            realized_sales_gross_profit_growth_rate: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Â∑≤ÂØ¶ÁèæÈä∑ÂîÆÊØõÂà©ÁöÑÊàêÈï∑ÈÄüÂ∫¶ÔºåÂèçÊò†Áî¢ÂìÅÊàñÊúçÂãôÂØ¶Ë≥™Áç≤Âà©ËÉΩÂäõÁöÑÊèêÂçáË∂®Âã¢„ÄÇ",
                formula: "(Êú¨ÊúüÂ∑≤ÂØ¶ÁèæÊØõÂà©-ÂâçÊúüÂ∑≤ÂØ¶ÁèæÊØõÂà©) √∑ ÂâçÊúüÂ∑≤ÂØ¶ÁèæÊØõÂà©",
                range: "5% ~ 20%"
            },
            // 70. Operating profit/Paid-in capital (ÁáüÊ•≠Âà©ÊΩ§Â∞çÂØ¶Êî∂Ë≥áÊú¨È°çÊØîÁéá)
            operating_profit_paid_in_capital_ratio: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠Âà©ÊΩ§Â∞çÂØ¶Êî∂Ë≥áÊú¨È°çÁöÑÊØîÁéáÔºåÂèçÊò†ËÇ°Êú¨ÁöÑÂü∫Êú¨Áç≤Âà©ËÉΩÂäõÂíåÁáüÈÅãÊïàÁéá„ÄÇ",
                formula: "ÁáüÊ•≠Âà©ÊΩ§ √∑ ÂØ¶Êî∂Ë≥áÊú¨È°ç",
                range: "5% ~ 15%"
            },
            // 71. Net profit before tax/Paid-in capital (Á®ÖÂâçÁ¥îÁõäÂ∞çÂØ¶Êî∂Ë≥áÊú¨È°çÊØîÁéá)
            net_profit_before_tax_paid_in_capital_ratio: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Á®ÖÂâçÁ¥îÁõäÂ∞çÂØ¶Êî∂Ë≥áÊú¨È°çÁöÑÊØîÁéáÔºåÈÄ≤‰∏ÄÊ≠•ËÄÉÊÖÆ‰∫ÜÈùûÁáüÊ•≠È†ÖÁõÆÂæåÁöÑÁ∂úÂêàÁç≤Âà©ËÉΩÂäõ„ÄÇ",
                formula: "Á®ÖÂâçÁ¥îÁõä √∑ ÂØ¶Êî∂Ë≥áÊú¨È°ç",
                range: "5% ~ 15%"
            },
            // 72. Net Income to Total Assets (ROA,Ë≥áÁî¢Â†±ÈÖ¨Áéá)
            net_income_to_total_assets: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Á®ÖÂæåÊ∑®Âà©Â∞çÁ∏ΩË≥áÁî¢ÁöÑÊØîÁéáÔºåË°°Èáè‰ºÅÊ•≠Êï¥È´îË≥áÁî¢Âà©Áî®ÁöÑÁç≤Âà©ËÉΩÂäõÂíåÁÆ°ÁêÜÊïàÁéá„ÄÇ",
                formula: "Á®ÖÂæåÊ∑®Âà© √∑ Âπ≥ÂùáÁ∏ΩË≥áÁî¢",
                range: "5% ~ 15%"
            },
            // 73. Net Income to Stockholder's Equity (ROE,Ê¨äÁõäÂ†±ÈÖ¨Áéá)
            net_income_to_stockholders_equity: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Á®ÖÂæåÊ∑®Âà©Â∞çËÇ°Êù±Ê¨äÁõäÁöÑÊØîÁéáÔºåË©ï‰º∞ËÇ°Êù±ÊäïÂÖ•Ë≥áÈáëÁöÑÂõûÂ†±Ê∞¥Âπ≥ÂíåËá™ÊúâË≥áÈáëÂà©Áî®ÊïàÁéá„ÄÇ",
                formula: "Á®ÖÂæåÊ∑®Âà© √∑ Âπ≥ÂùáËÇ°Êù±Ê¨äÁõä",
                range: "10% ~ 25%"
            },
            // 74. Gross Profit to Sales (ÊØõÂà©Áéá)
            gross_profit_to_sales: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÊØõÂà©ËàáÈä∑ÂîÆÊî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†Áî¢ÂìÅÊàñÊúçÂãôÁöÑÂü∫Êú¨Áç≤Âà©ËÉΩÂäõÂíåÊàêÊú¨ÊéßÂà∂Ê∞¥Âπ≥„ÄÇ",
                formula: "ÊØõÂà© √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "20% ~ 40%"
            },
            // 75. Net Income Flag (Ê∑®Âà©Ê®ôË®ò)
            net_income_flag: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ê®ôÁ§∫ÂÖ¨Âè∏ÊòØÂê¶Âá∫ÁèæÊ∑®ËôßÊêçÁöÑÊåáÊ®ôÔºåÁÇ∫1ÊôÇË°®Á§∫‰ºÅÊ•≠Áï∂ÊúüËôïÊñºËôßÊêçÁãÄÊÖãÔºåÊòØË≤°ÂãôÂÅ•Â∫∑ÁöÑÂü∫Êú¨Ë≠¶Á§∫„ÄÇ",
                formula: "Ëã•Ê∑®Âà©ÁÇ∫Ë≤†ÂâáÁÇ∫1ÔºõÂê¶ÂâáÁÇ∫0",
                range: "ÊáâÁÇ∫0"
            },
            // 76. Retained Earnings to Total Assets (‰øùÁïôÁõàÈ§òÂ∞çË≥áÁî¢ÊØîÁéá)
            retained_earnings_to_total_assets: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Á¥ØÁ©çÁöÑ‰øùÁïôÁõàÈ§òÁõ∏Â∞çÊñºÁ∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåÂèçÊò†Èï∑Êúü‰ª•‰æÜÁöÑÁç≤Âà©Á¥ØÁ©çÂíåËá™ÊàëÊàêÈï∑ËÉΩÂäõ„ÄÇ",
                formula: "‰øùÁïôÁõàÈ§ò √∑ Á∏ΩË≥áÁî¢",
                range: "5% ~ 20%"
            },
            // 77. Total assets to GNP price (Á∏ΩË≥áÁî¢Â∞çGNPÂÉπÊ†ºÊØîÁéá)
            total_assets_to_gnp_price: {
                category: "Áç≤Âà©ËÉΩÂäõ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Á∏ΩË≥áÁî¢Áõ∏Â∞çÊñºÂúãÊ∞ëÁîüÁî¢Á∏ΩÂÄºÂÉπÊ†ºÊåáÊï∏ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠Ë≥áÁî¢Ë¶èÊ®°ËàáÂÆèËßÄÁ∂ìÊøüÁí∞Â¢ÉÁöÑÈóú‰øÇ„ÄÇ",
                formula: "Á∏ΩË≥áÁî¢ √∑ GNPÂÉπÊ†ºÊåáÊï∏",
                range: "‰æùÁî¢Ê•≠ËÄåÁï∞"
            },
            // 78. Cash flow rate (ÁèæÈáëÊµÅÈáèÊØîÁéá)
            cash_flow_rate: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠Ê¥ªÂãïÁèæÈáëÊµÅÈáèÂ∞çÊµÅÂãïË≤†ÂÇµÁöÑË¶ÜËìãÁ®ãÂ∫¶ÔºåÂèçÊò†Áü≠ÊúüÂÇµÂãôÁöÑÁèæÈáëÂÑü‰ªòËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÊ•≠Ê¥ªÂãïÁèæÈáëÊµÅÈáè √∑ ÊµÅÂãïË≤†ÂÇµ",
                range: "5% ~ 15%"
            },
            // 79. Cash Reinvestment % (ÁèæÈáëÂÜçÊäïË≥áÊØîÁéá%)
            cash_reinvestment_percent: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë°°ÈáèÂÖ¨Âè∏Ëá™Áî±ÁèæÈáëÊµÅÈáèÂÜçÊäïÂÖ•Âà∞Èï∑ÊúüË≥áÁî¢ÂíåÁáüÈÅãË≥áÈáëÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠ÁöÑÂÜçÊäïË≥áÂº∑Â∫¶ËàáÊàêÈï∑ÊäïÂÖ•„ÄÇ",
                formula: "Ëá™Áî±ÁèæÈáëÊµÅÈáè √∑ (Âõ∫ÂÆöË≥áÁî¢ÊØõÈ°ç+Èï∑ÊúüÊäïË≥á+ÂÖ∂‰ªñË≥áÁî¢+ÁáüÈÅãË≥áÈáë) √ó 100%",
                range: "10% ~ 30%"
            },
            // 80. Cash Flow Per Share (ÊØèËÇ°ÁèæÈáëÊµÅÈáè)
            cash_flow_per_share: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë©ï‰º∞ÊØèËÇ°ËÇ°Á•®ÊâÄÂ∞çÊáâÁöÑÁáüÊ•≠Ê¥ªÂãïÁèæÈáëÊµÅÈáèÔºåÊèê‰æõ‰ª•ÁèæÈáëÊµÅÁÇ∫Âü∫Á§éÁöÑÊØèËÇ°ÂÉπÂÄºË©ï‰º∞„ÄÇ",
                formula: "ÁáüÊ•≠Ê¥ªÂãïÁèæÈáëÊµÅÈáè √∑ Âä†Ê¨äÂπ≥ÂùáÊµÅÈÄöËÇ°Êï∏",
                range: "Ê≠£ÂÄº‰∏îÁ©©ÂÆöÁÇ∫‰Ω≥"
            },
            // 81. Cash Flow to Sales (ÁèæÈáëÊµÅÈáèÂ∞çÈä∑ÂîÆÈ°çÊØîÁéá)
            cash_flow_to_sales: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠ÁèæÈáëÊµÅÈáèÁõ∏Â∞çÊñºÈä∑ÂîÆÊî∂ÂÖ•ÁöÑÊØî‰æãÔºåÂèçÊò†Èä∑ÂîÆÊî∂ÂÖ•ËΩâÂåñÁÇ∫ÁèæÈáëÁöÑËÉΩÂäõÂíåÂìÅË≥™„ÄÇ",
                formula: "ÁáüÊ•≠ÁèæÈáëÊµÅÈáè √∑ ÁáüÊ•≠Êî∂ÂÖ•",
                range: "5% ~ 15%"
            },
            // 82. Cash Flow to Total Assets (ÁèæÈáëÊµÅÈáèÂ∞çÁ∏ΩË≥áÁî¢ÊØîÁéá)
            cash_flow_to_total_assets: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÁáüÊ•≠ÁèæÈáëÊµÅÈáèÁõ∏Â∞çÊñºÁ∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåË©ï‰º∞Ë≥áÁî¢ÈÅãÁî®Áî¢ÁîüÁèæÈáëÁöÑÊïàÁéá„ÄÇ",
                formula: "ÁáüÊ•≠ÁèæÈáëÊµÅÈáè √∑ Á∏ΩË≥áÁî¢",
                range: "5% ~ 15%"
            },
            // 83. Cash Flow to Liability (ÁèæÈáëÊµÅÈáèÂ∞çË≤†ÂÇµÊØîÁéá)
            cash_flow_to_liability: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠ÁèæÈáëÊµÅÈáèÂ∞çÁ∏ΩË≤†ÂÇµÁöÑÊØîÁéáÔºåÂèçÊò†ÈÄöÈÅéÁ∂ìÁáüÊ¥ªÂãïÁî¢ÁîüÁöÑÁèæÈáëÂÑüÈÇÑÂÇµÂãôÁöÑËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÊ•≠ÁèæÈáëÊµÅÈáè √∑ Á∏ΩË≤†ÂÇµ",
                range: "5% ~ 15%"
            },
            // 84. CFO to Assets (ÁáüÊ•≠ÁèæÈáëÊµÅÈáèÂ∞çË≥áÁî¢ÊØîÁéá)
            cfo_to_assets: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÁáüÊ•≠Ê¥ªÂãïÁî¢ÁîüÁöÑÁèæÈáëÊµÅÈáèÁõ∏Â∞çÊñºÁ∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåË©ï‰º∞Á∂ìÁáüÊ¥ªÂãïÁöÑÁèæÈáëÂâµÈÄ†ÊïàÁéá„ÄÇ",
                formula: "ÁáüÊ•≠ÁèæÈáëÊµÅÈáè √∑ Á∏ΩË≥áÁî¢",
                range: "5% ~ 15%"
            },
            // 85. Cash Flow to Equity (ÁèæÈáëÊµÅÈáèÂ∞çÊ¨äÁõäÊØîÁéá)
            cash_flow_to_equity: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÊ•≠ÁèæÈáëÊµÅÈáèÂ∞çËÇ°Êù±Ê¨äÁõäÁöÑÊØî‰æãÔºåÂèçÊò†ËÇ°Êù±ÊäïË≥áÁç≤ÂæóÁèæÈáëÂõûÂ†±ÁöÑËÉΩÂäõ„ÄÇ",
                formula: "ÁáüÊ•≠ÁèæÈáëÊµÅÈáè √∑ ËÇ°Êù±Ê¨äÁõä",
                range: "5% ~ 15%"
            },
            // 86. Cash/TotalAssets(ÁèæÈáëÂ∞çË≥áÁî¢ÊØîÁéá)
            cash_total_assets: {
                category: "ÁèæÈáëÊµÅÈáè",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÁèæÈáëË≥áÁî¢Âç†Á∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠ÊµÅÂãïÊÄßÊúÄÈ´òË≥áÁî¢ÁöÑÊåÅÊúâÊ∞¥Âπ≥ÂíåÈùàÊ¥ªÊáâËÆäËÉΩÂäõ„ÄÇ",
                formula: "ÁèæÈáë √∑ Á∏ΩË≥áÁî¢",
                range: "5% ~ 20%"
            },
            // 87. Tax rate (A) (Á®ÖÁéáA)
            tax_rate_a: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÊâÄÂæóÁ®ÖË≤ªÁî®Âç†Á®ÖÂâçÊ∑®Âà©ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠ÂØ¶ÈöõÊâøÊìîÁöÑÊâÄÂæóÁ®ÖË≤†ÊìîÊ∞¥Âπ≥ÂíåÁ®ÖÂãôË¶èÂäÉÊïàÊûú„ÄÇ",
                formula: "ÊâÄÂæóÁ®ÖË≤ªÁî® √∑ Á®ÖÂâçÊ∑®Âà©",
                range: "‰æùÊ≥ïÂÆöÁ®ÖÁéá"
            },
            // 88. Working Capital to Total Assets (ÁáüÈÅãË≥áÈáëÂ∞çÁ∏ΩË≥áÁî¢ÊØîÁéá)
            working_capital_to_total_assets: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÁáüÈÅãË≥áÈáë(ÊµÅÂãïË≥áÁî¢Ê∏õÊµÅÂãïË≤†ÂÇµ)Âç†Á∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠Ë≥áÁî¢ÁöÑÊµÅÂãïÊÄßÁµêÊßãÂíåÁü≠ÊúüË≤°ÂãôÂΩàÊÄß„ÄÇ",
                formula: "ÁáüÈÅãË≥áÈáë √∑ Á∏ΩË≥áÁî¢",
                range: "10% ~ 30%"
            },
            // 89. Quick Assets/Total Assets (ÈÄüÂãïË≥áÁî¢Â∞çÁ∏ΩË≥áÁî¢ÊØîÁéá)
            quick_assets_total_assets: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÈÄüÂãïË≥áÁî¢Âç†Á∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠È´òÊµÅÂãïÊÄßË≥áÁî¢ÁöÑÈÖçÁΩÆÊ∞¥Âπ≥ÂíåÁü≠ÊúüÊáâËÆäËÉΩÂäõ„ÄÇ",
                formula: "ÈÄüÂãïË≥áÁî¢ √∑ Á∏ΩË≥áÁî¢",
                range: "10% ~ 30%"
            },
            // 90. Current Assets/Total Assets (ÊµÅÂãïË≥áÁî¢Â∞çÁ∏ΩË≥áÁî¢ÊØîÁéá)
            current_assets_total_assets: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÊµÅÂãïË≥áÁî¢Âç†Á∏ΩË≥áÁî¢ÁöÑÊØî‰æãÔºåÂèçÊò†‰ºÅÊ•≠Ë≥áÁî¢ÁöÑÊµÅÂãïÊÄßÊ∞¥Âπ≥ÂíåË≥áÁî¢ÁµêÊßãÁöÑÈùàÊ¥ªÂ∫¶„ÄÇ",
                formula: "ÊµÅÂãïË≥áÁî¢ √∑ Á∏ΩË≥áÁî¢",
                range: "30% ~ 60%"
            },
            // 91. Inventory/Working Capital (Â≠òË≤®Â∞çÁáüÈÅãË≥áÈáëÊØîÁéá)
            inventory_working_capital_ratio: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏Â≠òË≤®Âç†ÁáüÈÅãË≥áÈáëÁöÑÊØî‰æãÔºåÂèçÊò†ÁáüÈÅãË≥áÈáë‰∏≠Ë¢´Â≠òË≤®Âç†Áî®ÁöÑÁ®ãÂ∫¶ÂíåÁáüÈÅãË≥áÈáëÁöÑË≥™Èáè„ÄÇ",
                formula: "Â≠òË≤® √∑ ÁáüÈÅãË≥áÈáë",
                range: "20% ~ 50%"
            },
            // 92. Inventory/Current Liability (Â≠òË≤®Â∞çÊµÅÂãïË≤†ÂÇµÊØîÁéá)
            inventory_current_liability: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë°°ÈáèÂÖ¨Âè∏Â≠òË≤®Áõ∏Â∞çÊñºÊµÅÂãïË≤†ÂÇµÁöÑÊØî‰æãÔºåË©ï‰º∞‰ª•ËÆäÁèæÈÄüÂ∫¶ËºÉÊÖ¢ÁöÑÂ≠òË≤®‰æÜÂÑüÈÇÑÁü≠ÊúüÂÇµÂãôÁöÑÂèØËÉΩÊÄß„ÄÇ",
                formula: "Â≠òË≤® √∑ ÊµÅÂãïË≤†ÂÇµ",
                range: "20% ~ 50%"
            },
            // 93. Working Capital/Equity (ÁáüÈÅãË≥áÈáëÂ∞çÊ¨äÁõäÊØîÁéá)
            working_capital_equity: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë©ï‰º∞ÂÖ¨Âè∏ÁáüÈÅãË≥áÈáëÂç†ËÇ°Êù±Ê¨äÁõäÁöÑÊØî‰æãÔºåÂèçÊò†ËÇ°Êù±ÊäïÂÖ•Ë≥áÈáëÁî®ÊñºÊîØÊåÅÁü≠ÊúüÁáüÈÅãÈúÄÊ±ÇÁöÑÁ®ãÂ∫¶„ÄÇ",
                formula: "ÁáüÈÅãË≥áÈáë √∑ ËÇ°Êù±Ê¨äÁõä",
                range: "20% ~ 50%"
            },
            // 94. Current Liability to Liability (ÊµÅÂãïË≤†ÂÇµÂ∞çË≤†ÂÇµÊØîÁéá)
            current_liability_liability: {
                category: "ÂÖ∂‰ªñ",
                description: "Ë°°ÈáèÂÖ¨Âè∏ÊµÅÂãïË≤†ÂÇµÂç†Á∏ΩË≤†ÂÇµÁöÑÊØî‰æãÔºåÂèçÊò†Ë≤†ÂÇµÁµêÊßã‰∏≠ÁöÑÊúüÈôêÁµÑÊàêÂíåÁü≠ÊúüÂÑüÂÇµÂ£ìÂäõ„ÄÇ",
                formula: "ÊµÅÂãïË≤†ÂÇµ √∑ Á∏ΩË≤†ÂÇµ",
                range: "‰æùÁî¢Ê•≠ÁâπÊÄßËÄåÁï∞"
            }
        };

        // ÂàùÂßãÂåñË≤°ÂãôÊåáÊ®ôÈÅ∏ÊìáÂô®
        document.addEventListener('DOMContentLoaded', function() {
          const select = document.getElementById('financialMetric');
          const resultSection = document.getElementById('resultSection');
          
          // ÂèñÂæóÊâÄÊúâ key ‰∏¶ËΩâÊèõÈ°ØÁ§∫ÊñáÂ≠ó
          const sortedKeys = Object.keys(financialMetrics).sort((a, b) => {
            const textA = a.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            const textB = b.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            return textA.localeCompare(textB);
          });
          
          sortedKeys.forEach(key => {
            const option = document.createElement('option');
            option.value = key;
            option.textContent = key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            select.appendChild(option);
          });
          
          // Áï∂ÈÅ∏ÊìáËÆäÊõ¥ÊôÇÈ°ØÁ§∫Â∞çÊáâÁöÑÊåáÊ®ôË≥áË®ä
          select.addEventListener('change', function() {
            const selectedValue = this.value;
            if (selectedValue) {
              const metric = financialMetrics[selectedValue];
              document.getElementById('metricCategory').textContent = metric.category;
              document.getElementById('metricDescription').textContent = metric.description;
              document.getElementById('metricFormula').textContent = metric.formula;
              document.getElementById('metricRange').textContent = metric.range;
              resultSection.style.display = 'block';
            } else {
              resultSection.style.display = 'none';
            }
          });
        });

        function validateInput(input) {
            let value = input.value; // Áõ¥Êé•ËÆÄÂèñÂ≠ó‰∏≤Ôºå‰∏çËΩâÊèõÊï∏Â≠ó

            // Á¢∫‰øùÂÄºÊòØÊï∏Â≠óÊàñÁ©∫ÂÄºÔºàÂÖÅË®±‰ΩøÁî®ËÄÖÊ∏ÖÈô§Ëº∏ÂÖ•Ê°ÜÔºâ
            if (value === '' || isNaN(value)) {
                input.value = '';
                return;
            }

            // Á¢∫‰øùÊï∏ÂÄºÁØÑÂúçÂú® 0 ~ 999.9999 ‰πãÈñì
            let numericValue = parseFloat(value);
            if (numericValue < 0) {
                input.value = 0;  // ÂÖÅË®± 0
            } else if (numericValue > 999.9999) {
                input.value = 999.9999;
            }

            // Â¶ÇÊûúÊúâÂ∞èÊï∏ÔºåÁ¢∫‰øùÊúÄÂ§ö 4 ‰Ωç
            if (value.includes('.')) {
                let parts = value.split('.');
                if (parts[1].length > 4) {
                    input.value = numericValue.toFixed(4);
                }
            }
        }


        function updateThresholdDescription(value) {
            let icon, title, text, title2, text2;
            
            if (value <= 0.4) {
                icon = 'üîî';
                title = 'È¢®Èö™Ë©ï‰º∞Ê®ôÊ∫ñ';
                text = '‰øùÂÆàÔºåÂÆπÊòìÊ®ôÁÇ∫È´òÈ¢®Èö™';
                title2 = 'ÈÅ©Áî®Â†¥ÊôØ';
                text2 = 'È¢®Èö™ÂÅèÂ•ΩËºÉ‰ΩéÔºåÂ∏åÊúõÈ†êË≠¶Êõ¥ÈùàÊïè';
            } else if (value <= 0.7) {
                icon = '‚öñÔ∏è';
                title = 'È¢®Èö™Ë©ï‰º∞Ê®ôÊ∫ñ';
                text = 'Âπ≥Ë°°ÔºåÊ®ôÊ∫ñÈñæÂÄº';
                title2 = 'ÈÅ©Áî®Â†¥ÊôØ';
                text2 = 'Â§ßÂ§öÊï∏ÊáâÁî®ÔºåÊ®ôÊ∫ñÈ¢®Èö™Ë©ï‰º∞';
            } else {
                icon = 'üéØ';
                title = 'È¢®Èö™Ë©ï‰º∞Ê®ôÊ∫ñ';
                text = 'Âö¥Ê†ºÔºåÊ∏õÂ∞ëË™§Â†±È´òÈ¢®Èö™';
                title2 = 'ÈÅ©Áî®Â†¥ÊôØ';
                text2 = 'È¢®Èö™ÂÆπÂøçÂ∫¶ËºÉÈ´òÔºåÈÅøÂÖçË™§Âà§';
            }
            // ... existing code ...
        }

        // ËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑ
        function loadHistory() {
            fetch('/get-history')
                .then(response => response.json())
                .then(data => {
                    console.log("Áç≤ÂèñÁöÑÊ≠∑Âè≤Êï∏ÊìöÔºö", data);

                    if (data.is_empty) {
                        // Â¶ÇÊûúÊ≤íÊúâÊ≠∑Âè≤Ë®òÈåÑÔºåÈ°ØÁ§∫„ÄåÊ≠°ËøéË®äÊÅØ„Äç
                        document.getElementById('history-welcome').style.display = 'block';
                        document.getElementById('history-content').style.display = 'none';
                    } else {
                        // Âê¶ÂâáÈ°ØÁ§∫Ê≠∑Âè≤Êï∏Êìö
                        document.getElementById('history-welcome').style.display = 'none';
                        document.getElementById('history-content').style.display = 'block';

                        let historyHtml = "";
                        data.history.forEach(record => {
                            historyHtml += `
                                <div class="history-record">
                                    <p>ÂàÜÊûêÊôÇÈñì: ${new Date(record.timestamp).toLocaleString()}</p>
                                    <p>Ë≤°ÂãôÂÅ•Â∫∑Â∫¶: ${record.financial_health}</p>
                                    <img src="/static/history_data/${record.filename}" alt="ÂàÜÊûêÁµêÊûúÂúñÁâá" style="width: 100%; max-width: 150px;">
                                </div>
                            `;
                        });

                        document.getElementById('history-content').innerHTML = historyHtml;
                    }
                })
                .catch(error => {
                    console.error("Áç≤ÂèñÊ≠∑Âè≤Êï∏ÊìöÂ§±Êïó:", error);
                });
        }

        // Áï∂È†ÅÈù¢ËºâÂÖ•ÊôÇÂä†ËºâÊ≠∑Âè≤Êï∏Êìö
        document.addEventListener("DOMContentLoaded", loadHistory);

        // ‰∏ãËºâÂ†±Âëä
        function downloadReport(filename) {
            if (!filename) {
                alert('Êâæ‰∏çÂà∞Â†±ÂëäÊ™îÊ°à');
                return;
            }
            
            fetch(`/download-report/${filename}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('‰∏ãËºâÂ§±Êïó');
                    }
                    return response.blob();
                })
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                })
                .catch(error => {
                    console.error('‰∏ãËºâÂ†±ÂëäÂ§±Êïó:', error);
                    alert('‰∏ãËºâÂ†±ÂëäÊôÇÁôºÁîüÈåØË™§');
                });
        }

        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂü∑Ë°å
        document.addEventListener('DOMContentLoaded', loadHistory);

        // Êõ¥Êñ∞Ê≠∑Âè≤Ë®òÈåÑÈ°ØÁ§∫
        function updateHistoryDisplay() {
            const historyContent = document.getElementById('history-content');
            const historyWelcome = document.getElementById('history-welcome');
            
            if (historyRecords.length === 0) {
                historyContent.style.display = 'none';
                historyWelcome.style.display = 'block';
            } else {
                historyContent.style.display = 'block';
                historyWelcome.style.display = 'none';
                // Êõ¥Êñ∞Ê≠∑Âè≤Ë®òÈåÑÂÖßÂÆπ
                // ... ÂÖ∂‰ªñÊ≠∑Âè≤Ë®òÈåÑÈ°ØÁ§∫ÈÇèËºØ ...
            }
        }

        function createIndicatorInput(indicator) {
            return `
                <div class="indicator-input">
                    <label for="${indicator}">${indicator}</label>
                    <input type="number" 
                           id="${indicator}" 
                           name="${indicator}" 
                           placeholder="Ë´ãËº∏ÂÖ•Êï∏ÂÄº"
                           step="any"
                           min=""
                           max=""
                           required>
                </div>
            `;
        }

// -------------------------------------------------------------------------------------------------------------

        async function loadHistory() {
            try {
                const response = await fetch('/get-history');
                const data = await response.json();

                const historyContent = document.getElementById('history-content');
                const historyWelcome = document.getElementById('history-welcome');

                if (!data || data.is_empty || !data.history || data.history.length === 0) {
                    historyContent.style.display = 'none';
                    historyWelcome.style.display = 'block';
                    historyWelcome.innerHTML = `
                        <div class="welcome-message">
                            <h3>Ê≠°Ëøé‰ΩøÁî®Ë≤°ÂãôÂàÜÊûêÁ≥ªÁµ±</h3>
                            <p>ÁõÆÂâçÈÇÑÊ≤íÊúâÂàÜÊûêË®òÈåÑ„ÄÇÊÇ®ÂèØ‰ª•Ôºö</p>
                            <ul>
                                <li>‰∏äÂÇ≥Ê™îÊ°àÈÄ≤Ë°åÂàÜÊûê</li>
                                <li>ÊâãÂãïËº∏ÂÖ•Êï∏ÊìöÈÄ≤Ë°åÂàÜÊûê</li>
                            </ul>
                        </div>
                    `;
                    return;
                }

                historyContent.style.display = 'block';
                historyWelcome.style.display = 'none';

                const historyList = document.createElement('div');
                historyList.className = 'history-grid';

                data.history.forEach(record => {
                    const recordCard = document.createElement('div');
                    recordCard.className = 'history-card';
                    recordCard.innerHTML = `
                        <div class="history-card-header">
                            <h3 class="analysis-date">ÂàÜÊûêÂ†±Âëä ${new Date(record.timestamp).toLocaleDateString()}</h3>
                        </div>
                        <div class="history-card-content">
                            <div class="history-info">
                                <p class="financial-health">Ë≤°ÂãôÂÅ•Â∫∑Â∫¶Ôºö${(record.financial_health * 100).toFixed(2)}%</p> <!-- È°ØÁ§∫Ë≤°ÂãôÂÅ•Â∫∑Â∫¶ -->
                                <p class="prediction ${record.prediction > 0.5 ? 'healthy' : 'unhealthy'}">
                                    È†êÊ∏¨ÁµêÊûúÔºö${record.prediction > 0.5 ? 'Ë≤°ÂãôÂÅ•Â∫∑' : 'ÂèØËÉΩÁ†¥Áî¢'}
                                </p>
                            </div>
                            <button onclick="deleteRecord('${record.filename}')" class="delete-btn">
                                <i class="fas fa-trash"></i> Âà™Èô§Ë®òÈåÑ
                            </button>
                        </div>
                    `;
                    historyList.appendChild(recordCard);
                });

                historyContent.innerHTML = '';
                historyContent.appendChild(historyList);

            } catch (error) {
                console.error('ËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§:', error);
                const historyContent = document.getElementById('history-content');
                const historyWelcome = document.getElementById('history-welcome');
                historyContent.style.display = 'none';
                historyWelcome.style.display = 'block';
                historyWelcome.innerHTML = `
                    <div class="error-message">
                        <h3>ËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§</h3>
                        <p>Ë´ãÁ®çÂæåÂÜçË©¶„ÄÇÂ¶ÇÊûúÂïèÈ°åÊåÅÁ∫åÂ≠òÂú®ÔºåË´ãËÅØÁπ´Á≥ªÁµ±ÁÆ°ÁêÜÂì°„ÄÇ</p>
                    </div>
                `;
            }
        }
// -------------------------------------------------------------------------------------------------------------
        // Ê∑ªÂä†Áõ∏ÈóúÁöÑ CSS Ê®£Âºè
        const style = document.createElement('style');
        style.textContent = `
            .history-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
                gap: 20px;
                padding: 20px;
                max-width: 1200px;
                margin: 0 auto;
            }
            
            .history-card {
                background: white;
                border-radius: 10px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                overflow: hidden;
                display: flex;
                flex-direction: column;
            }
            
            .history-card-header {
                background: #f8f9fa;
                padding: 15px;
                border-bottom: 1px solid #eee;
            }
            
            .analysis-date {
                margin: 0;
                color: #007bff;
                font-size: 1.2rem;
                font-weight: bold;
            }
            
            .history-card-content {
                padding: 20px;
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
            
            .history-info {
                margin-bottom: 20px;
            }
            
            .financial-health {
                font-size: 1.2rem;
                color: #333;
                margin: 10px 0;
                font-weight: 500;
            }
            
            .prediction {
                font-size: 1.2rem;
                margin: 10px 0;
                font-weight: 500;
            }
            
            .prediction.healthy {
                color: #28a745;
            }
            
            .prediction.unhealthy {
                color: #dc3545;
            }
            
            .delete-btn {
                background: #dc3545;
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 5px;
                cursor: pointer;
                transition: background 0.2s;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
                font-size: 1rem;
                width: 100%;
                margin-top: auto;
            }
            
            .delete-btn:hover {
                background: #c82333;
            }
            
            .welcome-message {
                text-align: center;
                padding: 40px;
                background: #f8f9fa;
                border-radius: 10px;
                margin: 20px auto;
                max-width: 800px;
            }
            
            .welcome-message h3 {
                color: #333;
                margin-bottom: 20px;
                font-size: 1.5rem;
            }
            
            .welcome-message ul {
                list-style: none;
                padding: 0;
            }
            
            .welcome-message li {
                margin: 15px 0;
                color: #666;
                font-size: 1.1rem;
            }
            
            @media (max-width: 768px) {
                .history-grid {
                    grid-template-columns: 1fr;
                }
            }
        `;
        document.head.appendChild(style);

        // ‰∏ãËºâÂ†±ÂëäÂäüËÉΩ
        async function downloadReport(filename) {
            try {
                window.location.href = `/download-report/${filename}`;
            } catch (error) {
                console.error('‰∏ãËºâÂ†±ÂëäÊôÇÁôºÁîüÈåØË™§:', error);
                alert('‰∏ãËºâÂ†±ÂëäÊôÇÁôºÁîüÈåØË™§ÔºåË´ãÁ®çÂæåÂÜçË©¶');
            }
        }

        // Âà™Èô§ÂñÆÂÄãË®òÈåÑ
        async function deleteRecord(filename) {
            try {
                if (!confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÊ¢ùË®òÈåÑÂóéÔºü')) {
                    return;
                }
                
                console.log(`ÈñãÂßãÂà™Èô§Ë®òÈåÑ: ${filename}`);
                
                // Á´ãÂç≥Âæû UI ‰∏≠ÁßªÈô§Ë©≤Ë®òÈåÑÂç°ÁâáÔºåÊèê‰æõÊõ¥Â•ΩÁöÑÁî®Êà∂È´îÈ©ó
                const recordToDelete = document.querySelector(`.history-card[data-filename="${filename}"]`);
                if (recordToDelete) {
                    // Ê∑ªÂä†Ê∑°Âá∫ÊïàÊûú
                    recordToDelete.style.transition = 'opacity 0.3s, transform 0.3s';
                    recordToDelete.style.opacity = '0';
                    recordToDelete.style.transform = 'scale(0.9)';
                    
                    // Ë®≠ÁΩÆÂª∂ÈÅ≤ÂæåÁßªÈô§ÂÖÉÁ¥†
                    setTimeout(() => {
                        recordToDelete.remove();
                        
                        // Ê™¢Êü•ÊòØÂê¶ÊâÄÊúâË®òÈåÑÈÉΩË¢´Âà™Èô§ÔºåÂ¶ÇÊûúÊòØÂâáÈ°ØÁ§∫Ê≠°ËøéË®äÊÅØ
                        const remainingCards = document.querySelectorAll('.history-card');
                        if (remainingCards.length === 0) {
                            const historyContent = document.getElementById('history-content');
                            const historyWelcome = document.getElementById('history-welcome');
                            
                            historyContent.style.display = 'none';
                            historyWelcome.style.display = 'block';
                            historyWelcome.innerHTML = `
                                <div class="welcome-message">
                                    <h3>Ê≠°Ëøé‰ΩøÁî®Ë≤°ÂãôÂàÜÊûêÁ≥ªÁµ±</h3>
                                    <p>ÁõÆÂâçÈÇÑÊ≤íÊúâÂàÜÊûêË®òÈåÑ„ÄÇÊÇ®ÂèØ‰ª•Ôºö</p>
                                    <ul>
                                        <li>‰∏äÂÇ≥Ê™îÊ°àÈÄ≤Ë°åÂàÜÊûê</li>
                                        <li>ÊâãÂãïËº∏ÂÖ•Êï∏ÊìöÈÄ≤Ë°åÂàÜÊûê</li>
                                    </ul>
                                </div>
                            `;
                        }
                    }, 300);
                }
                
                // Âú®ËÉåÊôØËôïÁêÜÂà™Èô§Ë´ãÊ±Ç
                const response = await fetch(`/api/delete-record/${filename}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log(`Êî∂Âà∞Âà™Èô§Ë´ãÊ±ÇÈüøÊáâ, ÁãÄÊÖãÁ¢º: ${response.status}`);
                
                const result = await response.json();
                console.log(`ÈüøÊáâÁµêÊûú:`, result);
                
                if (!result.success) {
                    console.error(`API ÂõûÂÇ≥Âà™Èô§Â§±Êïó: ${result.message || 'Êú™Áü•ÈåØË™§'}`);
                    // ‰∏çÈúÄË¶ÅÈáçÊñ∞ËºâÂÖ•Êï¥ÂÄãÂàóË°®ÔºåÂõ†ÁÇ∫ÊàëÂÄëÂ∑≤Á∂ìÂú® UI ‰∏≠ÁßªÈô§‰∫ÜÂÖÉÁ¥†
                }
            } catch (error) {
                console.error('Âà™Èô§Ë®òÈåÑÊôÇÁôºÁîüÈåØË™§:', error);
                // Â¶ÇÊûúÂá∫ÈåØÔºåÈáçÊñ∞ËºâÂÖ•Ê≠∑Âè≤Ë®òÈåÑ‰ª•Á¢∫‰øù UI ËàáÂæåÁ´ØÂêåÊ≠•
                alert('Âà™Èô§Ë®òÈåÑËôïÁêÜÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§ÔºåÊ≠£Âú®ÈáçÊñ∞ËºâÂÖ•');
                await loadHistory();
            }
        }
        
        // Âà™Èô§ÊâÄÊúâË®òÈåÑ
        async function deleteAllRecords() {
            try {
                if (!confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÊâÄÊúâË®òÈåÑÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÊÅ¢Âæ©ÔºÅ')) {
                    return;
                }
                
                // Á´ãÂç≥Âæû UI ÁßªÈô§ÊâÄÊúâË®òÈåÑÂç°Áâá
                const historyCards = document.querySelectorAll('.history-card');
                historyCards.forEach(card => {
                    card.style.transition = 'opacity 0.3s, transform 0.3s';
                    card.style.opacity = '0';
                    card.style.transform = 'scale(0.9)';
                });
                
                // Ë®≠ÁΩÆÂª∂ÈÅ≤ÂæåÊ∏ÖÁ©∫Ê≠∑Âè≤ÂÖßÂÆπÔºåÈ°ØÁ§∫Ê≠°ËøéË®äÊÅØ
                setTimeout(() => {
                    const historyContent = document.getElementById('history-content');
                    const historyWelcome = document.getElementById('history-welcome');
                    
                    historyContent.style.display = 'none';
                    historyWelcome.style.display = 'block';
                    historyWelcome.innerHTML = `
                        <div class="welcome-message">
                            <h3>Ê≠°Ëøé‰ΩøÁî®Ë≤°ÂãôÂàÜÊûêÁ≥ªÁµ±</h3>
                            <p>ÁõÆÂâçÈÇÑÊ≤íÊúâÂàÜÊûêË®òÈåÑ„ÄÇÊÇ®ÂèØ‰ª•Ôºö</p>
                            <ul>
                                <li>‰∏äÂÇ≥Ê™îÊ°àÈÄ≤Ë°åÂàÜÊûê</li>
                                <li>ÊâãÂãïËº∏ÂÖ•Êï∏ÊìöÈÄ≤Ë°åÂàÜÊûê</li>
                            </ul>
                        </div>
                    `;
                }, 300);
                
                // Âú®ËÉåÊôØËôïÁêÜÂà™Èô§Ë´ãÊ±Ç
                const response = await fetch('/api/delete-all-records', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (!result.success) {
                    console.error(`API ÂõûÂÇ≥Âà™Èô§ÊâÄÊúâË®òÈåÑÂ§±Êïó: ${result.message || 'Êú™Áü•ÈåØË™§'}`);
                }
            } catch (error) {
                console.error('Âà™Èô§ÊâÄÊúâË®òÈåÑÊôÇÁôºÁîüÈåØË™§:', error);
                alert('Âà™Èô§ÊâÄÊúâË®òÈåÑÊôÇÁôºÁîüÈåØË™§ÔºåË´ãÁ®çÂæåÂÜçË©¶');
                // ÁÑ°Ë´ñÂ¶Ç‰ΩïÈÉΩÈáçÊñ∞ËºâÂÖ•Ê≠∑Âè≤ÔºåÁ¢∫‰øùÈ†ÅÈù¢ËàáÂæåÁ´ØÂêåÊ≠•
                await loadHistory();
            }
        }

        // ÂàùÂßãÂåñÈ†ÅÈù¢
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('uploadForm').addEventListener('submit', async function(event) {
                event.preventDefault();
                
                const fileInput = document.getElementById('fileInput');
                const formData = new FormData();
                formData.append('file', fileInput.files[0]);

                try {
                    const response = await fetch('/submit-file', {
                        method: 'POST',
                        body: formData
                    });

                    const text = await response.text();
                    try {
                        const data = JSON.parse(text);
                        if (data.success) {
                            alert('Ê™îÊ°à‰∏äÂÇ≥ÊàêÂäü');
                        } else {
                            alert('ÈåØË™§: ' + data.message);
                        }
                    } catch (error) {
                        console.error('‰º∫ÊúçÂô®ÂõûÊáâÈùû JSON:', text);
                        alert('‰º∫ÊúçÂô®ÈåØË™§');
                    }
                } catch (error) {
                    console.error('Êèê‰∫§Â§±Êïó:', error);
                    alert('Êèê‰∫§Â§±ÊïóÔºåË´ãÊ™¢Êü•‰º∫ÊúçÂô®');
                }
            });

            function toggleInputMethod() {
                const inputMethod = document.getElementById('inputMethod').value;
                document.getElementById('file-upload-container').style.display = inputMethod === 'file' ? 'block' : 'none';
                document.getElementById('manual-input-container').style.display = inputMethod === 'manual' ? 'block' : 'none';
            }

            document.getElementById('inputMethod').addEventListener('change', toggleInputMethod);

            // Èö±ËóèÂàÜÊûêÁµêÊûúÂçÄÂüüÔºåÁ≠âÂæÖÂàÜÊûêÂæåÈ°ØÁ§∫
            const analysisResults = document.getElementById('analysis-results');
            if (analysisResults) {
                analysisResults.style.display = 'none';
            }
        });

    </script>
</body>
</html>